webpackJsonp([2],{0:function(e,t,n){var i,r,o,s,a,l,c,u,d,h,p,f,m,g,v,b,y,w,_;m=n(4),i=n(3),o=n(2),c=n(5),n(33),n(31),d=n(10),p=n(6),s=n(45),f=n(32),r=n(91),n(92),a=n(103).EditBarView,n(96),n(94),n(100),l=o.Radio.channel("global"),u=o.Radio.channel("messages"),h=o.Radio.channel("resources"),y=function(e,t){var n,i,r,o;return o=l.request("main:app:regions"),n=l.request("main:app:appmodel"),i=new f.MainPageLayout,i.on("show",function(e){return function(){var e,n,i,r;return i=new f.BootstrapNavBarView({model:t}),r=o.get("navbar"),r.show(i),e=new f.MessagesView({collection:u.request("messages")}),n=o.get("messages"),n.show(e)}}(this)),r=o.get("mainview"),r.show(i)},w=function(e,t,n){var i,r,a;return a=t.get("regions"),"modal"in a&&(a.modal=s),r=new o.Marionette.RegionManager,r.addRegions(a),i=r.get("navbar"),i.on("show",function(e){return function(){return l.trigger("appregion:navbar:displayed")}}(this)),l.reply("main:app:object",function(){return e}),l.reply("main:app:regions",function(){return r}),l.reply("main:app:get-region",function(e){return r.get(e)}),e.on("start",function(){var e,i,r,s,a,c;for(i=t.get("frontdoor_app"),l.request("applet:"+i+":route"),a=t.get("applets"),r=0,s=a.length;s>r;r++)e=a[r],c="applet:"+e.appname+":route",l.request(c);return l.request("mainpage:init",t,n),o.history.started?void 0:o.history.start()})},l.reply("main:app:appmodel",function(){return r}),l.reply("mainpage:init",function(e){return function(e,t){var n;return n=l.request("main:app:object"),y(n,t),l.trigger("mainpage:displayed")}}(this)),l.on("appregion:navbar:displayed",function(){var e,t;return t=new f.MainSearchFormView({model:h.request("current-document")}),e=l.request("main:app:get-region","search"),e.show(t)}),l.reply("make-editbar",function(e){var t,n,i,r;return t=e.get("data"),i=t.relationships.meta.current_user,n=l.request("main:app:get-region","editbar"),i&&"title"in i?(r=new a({model:e}),n.show(r)):n.empty()}),g=new c.Application,b=location.pathname,p.str_endswith(b,"@@dashboard")&&(b=b.split("@@dashboard")[0]),"/"===b&&(b=""),v=h.request("get-document",b),h.reply("current-document",function(){return v}),_=v.fetch(),_.done(function(){var e;return w(g,r,v),g.start(),e=v.get("data"),i("title").text(e.attributes.title)}),e.exports=g},44:function(e,t,n){var i,r,o,s,a,l,c,u,d,h,p,f,m,g,v,b,y,w;i=n(3),o=n(4),b=n(8),g=n(19),m=g.navbar_collapse_button,u=g.dropdown_toggle,v=n(11),f=v.frontdoor_url,p=v.editor_url,y=v.user_menu_dropdown,w=b.renderable(function(e){var t,n,i,r;return i=e.data.relationships.meta,r=i.workflow,b.li(".dropdown",function(){var e,t;return(null!=(e=r.current_state)?e.current:void 0)&&(null!=(t=i.has_permission)?t.state_change:void 0)?(u(function(){return b.span(".state-"+r.current_state.name,function(){return b.text(r.current_state.title),b.b(".caret")})}),b.ul(".dropdown-menu",function(){var e,t,n,i,o;for(n=r.transitions,i=[],e=0,t=n.length;t>e;e++)o=n[e],i.push(b.li(function(){return b.a({href:"#workflow-change"},function(){return b.text("Make "),b.span(r.states[o.to_state].title)})}));return i})):void 0}),(null!=(t=r.current_state)?t.current:void 0)&&!(null!=(n=i.has_permission)?n.state_change:void 0)?b.a(".state-"+r.current_state.name,function(){return b.text(r.current_state.title)}):void 0}),c=b.renderable(function(e){var t,n,i,r,o,s,a;for(o=e.data.relationships.meta,b.li(".divider"),b.li(".dropdown-header",{role:"presentation"},function(){return b.text("Set default view")}),r=o.selectable_default_views,s=[],n=0,i=r.length;i>n;n++)a=r[n],t={},a.is_current||(t.href="@@@set-default-view"),s.push(b.li(function(){return b.a(t,function(){return b.text(a.title),a.is_current?b.b(".glyphicon.glyphicon-ok.pull-right"):void 0})}));return s}),s=b.renderable(function(e){var t;return t=e.data.relationships.meta,b.li(".dropdown",function(){return u(function(){return b.span("Actions"),b.b(".caret")}),b.ul(".dropdown-menu",function(){var n,i,r,o;for(o=t.link_parent,n=0,i=o.length;i>n;n++)r=o[n],b.li(function(){return b.a({href:"#"},r.title)});return"Document"===e.data.type&&b.li(function(){return b.a({href:"#editor/hallo-edit"+e.id},"On Page Edit")}),c(e)})})}),a=b.renderable(function(e){var t,n;return n=e.data.relationships.meta,t=n.content_type_factories,b.li(".dropdown",function(){return u(function(){return b.span("Add"),b.b(".caret")}),b.ul(".dropdown-menu",function(){var e,i,r;for(i=0,r=t.length;r>i;i++)e=t[i],b.li(function(){var t;return t="#editor/"+e.command+e.resource,b.a({href:t},e.title)});return t?(b.li(".divider"),b.li(function(){return b.a({href:n.upload_url},"Upload Content")})):void 0})})}),h=b.renderable(function(e){var t,n;return t=e.data.relationships.meta,n=t.paths.this_path,b.div(".container-fluid",function(){return b.div(".navbar-header",function(){return m("navbar-edit")}),b.div("#navbar-edit.collapse.navbar-collapse",function(){return b.ul(".nav.navbar-nav.navbar-left",function(){var i,r,o,l,c;for(t.has_permission.edit&&w(e),r="",t.request_url===t.api_url&&(r=".active"),b.li(function(){var e;return e=f(n),b.a({href:e},"View")}),c=t.edit_links,i=0,o=c.length;o>i;i++)l=c[i],b.li(function(){var e;return e=p(l.name,n),b.a({href:e},l.title)});return t.has_permission.edit&&s(e),t.has_permission.add?(b.li(".divider-vertical"),a(e)):void 0}),b.ul(".nav.navbar-nav.navbar-right",function(){var n;return n=".pull-right",t.request_url===t.navigate_url&&(n+=".active"),b.li(n,function(){return b.a({href:t.navigate_url},"Navigate")}),y(e)})})})}),d=b.renderable(function(e){return b.nav("#editor-bar.navbar.navbar-default.navbar-static-top",function(){return h(e)})}),r=b.renderable(function(){return b.div("#navbar-view-container"),b.div("#editor-bar-container"),b.div(".container",function(){return b.div("#breadcrumbs"),b.div(".row",function(){return b.div("#main-content.col-md-9"),b.div("#right-slot.col-md-3.right-column")})}),b.div("#footer"),b.div("#modal")}),l=b.renderable(function(e){var t;return t=e.data.relationships.meta,b.ol(".breadcrumb",function(){var e,n,i,r,o;for(b.small("You are here:  "),r=t.breadcrumbs,o=[],e=0,i=r.length;i>e;e++)n=r[e],o.push(b.li(function(){return b.a({href:n.url},n.title)}));return o})}),e.exports={workflow_dropdown:w,editor_bar_pt:d}},71:function(e,t,n){var i,r,o=function(e,t){return function(){return e.apply(t,arguments)}},s=function(e,t){function n(){this.constructor=e}for(var i in t)a.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},a={}.hasOwnProperty;r=n(111),i=function(e){function t(){return this.invalid=o(this.invalid,this),this.valid=o(this.valid,this),t.__super__.constructor.apply(this,arguments)}return s(t,e),t.prototype.valid=function(e,t,n){return this.$("[data-validation="+t+"]").parent().removeClass("has-error").addClass("has-success")},t.prototype.invalid=function(e,t,n,i){return this.failure(this.model),this.$("[data-validation="+t+"]").parent().removeClass("has-success").addClass("has-error")},t}(r),e.exports=i},72:function(e,t,n){var i,r,o,s,a,l;i=n(3),r=n(4),l=n(8),o=l.renderable(function(e){return l.div(".form-group",function(){var t;return l.label(".control-label",{"for":e.input_id},e.label),(t=(null!=e?e.input_type:void 0)?e.input_type:l.input)("#"+e.input_id+".form-control",e.input_attributes)})}),s=l.renderable(function(e){return l.form({role:"form",method:"POST",action:"/login"},function(){return o({input_id:"input_username",label:"User Name",input_attributes:{name:"username",placeholder:"User Name"}}),o({input_id:"input_password",label:"Password",input_attributes:{name:"password",type:"password",placeholder:"Type your password here...."}}),l.button(".btn.btn-default",{type:"submit"},"login")})}),a=l.renderable(function(e){return o({input_id:"input_name",label:"Name",input_attributes:{name:"name",placeholder:"Name"}}),o({input_id:"input_content",input_type:l.textarea,label:"Content",input_attributes:{name:"content",placeholder:"..."}}),l.input(".btn.btn-default.btn-xs",{type:"submit",value:"Add"})}),e.exports={form_group_input_div:o,login_form:s,name_content_form:a}},73:function(e,t,n){var i,r,o,s,a;i=n(3),o=n(4),r=n(2),a=n(8),s=a.renderable(function(){return a.div("#ace-editor",{style:"position:relative;width:100%;height:40em;"})}),e.exports={ace_editor_div:s}},76:function(e,t,n){!function(t){e.exports=t(n(2),n(4))}(function(e,t){return e.Validation=function(e){"use strict";var t={forceUpdate:!1,selector:"name",labelFormatter:"sentenceCase",valid:Function.prototype,invalid:Function.prototype},n={formatLabel:function(e,n){return l[t.labelFormatter](e,n)},format:function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return t.replace(/\{(\d+)\}/g,function(t,n){return"undefined"!=typeof e[n]?e[n]:t})}},i=function(t,n,r){return n=n||{},r=r||"",e.each(t,function(e,o){t.hasOwnProperty(o)&&(e&&"object"==typeof e&&!(e instanceof Date||e instanceof RegExp)?i(e,n,r+o+"."):n[r+o]=e)}),n},r=function(){var r=function(t){return e.reduce(e.keys(t.validation||{}),function(e,t){return e[t]=void 0,e},{})},s=function(t,n){var i=t.validation?t.validation[n]||{}:{};return(e.isFunction(i)||e.isString(i))&&(i={fn:i}),e.isArray(i)||(i=[i]),e.reduce(i,function(t,n){return e.each(e.without(e.keys(n),"msg"),function(e){t.push({fn:c[e],val:n[e],msg:n.msg})}),t},[])},a=function(t,i,r,o){return e.reduce(s(t,i),function(s,a){var l=e.extend({},n,c),u=a.fn.call(l,r,i,a.val,t,o);return u===!1||s===!1?!1:u&&!s?a.msg||u:s},"")},l=function(t,n){var r,o={},s=!0,l=e.clone(n),c=i(n);return e.each(c,function(e,n){r=a(t,n,e,l),r&&(o[n]=r,s=!1)}),{invalidAttrs:o,isValid:s}},u=function(t,n){return{preValidate:function(t,n){return a(this,t,n,e.extend({},this.attributes))},isValid:function(t){var n=i(this.attributes);return e.isString(t)?!a(this,t,n[t],e.extend({},this.attributes)):e.isArray(t)?e.reduce(t,function(t,i){return t&&!a(this,i,n[i],e.extend({},this.attributes))},!0,this):(t===!0&&this.validate(),this.validation?this._isValid:!0)},validate:function(o,s){var a=this,c=!o,u=e.extend({},n,s),d=r(a),h=e.extend({},d,a.attributes,o),p=i(o||h),f=l(a,h);return a._isValid=f.isValid,e.each(d,function(e,n){var i=f.invalidAttrs.hasOwnProperty(n);i||u.valid(t,n,u.selector)}),e.each(d,function(e,n){var i=f.invalidAttrs.hasOwnProperty(n),r=p.hasOwnProperty(n);i&&(r||c)&&u.invalid(t,n,f.invalidAttrs[n],u.selector)}),e.defer(function(){a.trigger("validated",a._isValid,a,f.invalidAttrs),a.trigger("validated:"+(a._isValid?"valid":"invalid"),a,f.invalidAttrs)}),!u.forceUpdate&&e.intersection(e.keys(f.invalidAttrs),e.keys(p)).length>0?f.invalidAttrs:void 0}}},d=function(t,n,i){e.extend(n,u(t,i))},h=function(e){delete e.validate,delete e.preValidate,delete e.isValid},p=function(e){d(this.view,e,this.options)},f=function(e){h(e)};return{version:"0.7.1",configure:function(n){e.extend(t,n)},bind:function(n,i){var r=n.model,s=n.collection;if(i=e.extend({},t,o,i),"undefined"==typeof r&&"undefined"==typeof s)throw"Before you execute the binding your view must have a model or a collection.\nSee http://thedersen.com/projects/backbone-validation/#using-form-model-validation for more information.";r?d(n,r,i):s&&(s.each(function(e){d(n,e,i)}),s.bind("add",p,{view:n,options:i}),s.bind("remove",f))},unbind:function(e){var t=e.model,n=e.collection;t&&h(e.model),n&&(n.each(function(e){h(e)}),n.unbind("add",p),n.unbind("remove",f))},mixin:u(null,t)}}(),o=r.callbacks={valid:function(e,t,n){e.$("["+n+'~="'+t+'"]').removeClass("invalid").removeAttr("data-error")},invalid:function(e,t,n,i){e.$("["+i+'~="'+t+'"]').addClass("invalid").attr("data-error",n)}},s=r.patterns={digits:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},a=r.messages={required:"{0} is required",acceptance:"{0} must be accepted",min:"{0} must be greater than or equal to {1}",max:"{0} must be less than or equal to {1}",range:"{0} must be between {1} and {2}",length:"{0} must be {1} characters",minLength:"{0} must be at least {1} characters",maxLength:"{0} must be at most {1} characters",rangeLength:"{0} must be between {1} and {2} characters",oneOf:"{0} must be one of: {1}",equalTo:"{0} must be the same as {1}",pattern:"{0} must be a valid {1}"},l=r.labelFormatters={none:function(e){return e},sentenceCase:function(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,t){return 0===t?e.toUpperCase():" "+e.toLowerCase()}).replace("_"," ")},label:function(e,t){return t.labels&&t.labels[e]||l.sentenceCase(e,t)}},c=r.validators=function(){var t=String.prototype.trim?function(e){return null===e?"":String.prototype.trim.call(e)}:function(e){var t=/^\s+/,n=/\s+$/;return null===e?"":e.toString().replace(t,"").replace(n,"")},n=function(t){return e.isNumber(t)||e.isString(t)&&t.match(s.number)},i=function(n){return!(e.isNull(n)||e.isUndefined(n)||e.isString(n)&&""===t(n))};return{fn:function(t,n,i,r,o){return e.isString(i)&&(i=r[i]),i.call(r,t,n,o)},required:function(t,n,r,o,s){var l=e.isFunction(r)?r.call(o,t,n,s):r;return l||i(t)?l&&!i(t)?this.format(a.required,this.formatLabel(n,o)):void 0:!1},acceptance:function(t,n,i,r){return"true"===t||e.isBoolean(t)&&t!==!1?void 0:this.format(a.acceptance,this.formatLabel(n,r))},min:function(e,t,i,r){return!n(e)||i>e?this.format(a.min,this.formatLabel(t,r),i):void 0},max:function(e,t,i,r){return!n(e)||e>i?this.format(a.max,this.formatLabel(t,r),i):void 0},range:function(e,t,i,r){return!n(e)||e<i[0]||e>i[1]?this.format(a.range,this.formatLabel(t,r),i[0],i[1]):void 0},length:function(e,n,r,o){return i(e)&&t(e).length===r?void 0:this.format(a.length,this.formatLabel(n,o),r)},minLength:function(e,n,r,o){return!i(e)||t(e).length<r?this.format(a.minLength,this.formatLabel(n,o),r):void 0},maxLength:function(e,n,r,o){return!i(e)||t(e).length>r?this.format(a.maxLength,this.formatLabel(n,o),r):void 0},rangeLength:function(e,n,r,o){return!i(e)||t(e).length<r[0]||t(e).length>r[1]?this.format(a.rangeLength,this.formatLabel(n,o),r[0],r[1]):void 0},oneOf:function(t,n,i,r){return e.include(i,t)?void 0:this.format(a.oneOf,this.formatLabel(n,r),i.join(", "))},equalTo:function(e,t,n,i,r){return e!==r[n]?this.format(a.equalTo,this.formatLabel(t,i),this.formatLabel(n,i)):void 0},pattern:function(e,t,n,r){return i(e)&&e.toString().match(s[n]||n)?void 0:this.format(a.pattern,this.formatLabel(t,r),n)}}}();return r}(t),e.Validation})},90:function(e,t,n){var i,r,o,s,a,l,c,u,d,h=function(e,t){function n(){this.constructor=e}for(var i in t)p.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},p={}.hasOwnProperty;i=n(3),d=n(4),r=n(2),a=n(5),c=n(10),s=r.Radio.channel("global"),l=r.Radio.channel("messages"),u=r.Radio.channel("resources"),o=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return h(t,e),t.prototype.parse=function(e){return e.data},t}(r.Collection),e.exports={BaseCollection:o}},91:function(e,t,n){var i,r,o,s,a,l,c,u=function(e,t){function n(){this.constructor=e}for(var i in t)d.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},d={}.hasOwnProperty;i=n(3),c=n(3),s=n(4),r=n(2),o=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return u(t,e),t.prototype.defaults={brand:{name:"Brand",url:"/"},frontdoor_app:"frontdoor",hasUser:!1,frontdoor_sidebar:[{name:"Home",url:"/"}],applets:[],regions:{},routes:[]},t}(r.Model),l={mainview:"body",navbar:"#navbar-view-container",editbar:"#editor-bar-container",sidebar:"#sidebar",breadcrumbs:"#breadcrumbs",content:"#main-content",messages:"#messages",footer:"#footer",modal:"#modal",usermenu:"#user-menu",search:"#form-search-container"},a=new o({hasUser:!0,brand:{name:"Kotti",url:"/"},applets:[{appname:"editcontents",name:"Edit Contents",url:"#editor"},{appname:"setupusers",name:"Setup Users",url:"#setupusers"}],regions:l}),e.exports=a},92:function(e,t,n){var i,r,o,s,a,l,c,u,d,h,p,f,m,g=function(e,t){function n(){this.constructor=e}for(var i in t)v.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},v={}.hasOwnProperty;i=n(3),f=n(4),r=n(2),u=n(5),h=n(10),o=n(90).BaseCollection,c=r.Radio.channel("global"),d=r.Radio.channel("messages"),p=r.Radio.channel("resources"),a=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return g(t,e),t.prototype.copy_status="copy",t.prototype._add_models=function(e,t){return this.reset(),this.add(e),this.copy_status=t},t.prototype.copy=function(e){return this._add_models(e,"copy")},t.prototype.cut=function(e){return this._add_models(e,"cut")},t.prototype.paste=function(){var e;return e=this.models.slice(),this.reset(),e},t}(r.Collection),m=new a,c.reply("main:app:kotti-clipboard",function(){return m}),s=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return g(t,e),t.prototype.idAttribute="oid",t}(h.BaseKottiResource),l=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return g(t,e),t.prototype.model=s,t.prototype.url=function(){return this.resource_id+"/@@contents-json"},t}(o),p.reply("get-document-contents",function(e){var t;return null==e&&(e=""),t=new l,t.resource_id=e,t}),e.exports=a},93:function(e,t,n){var i,r,o,s,a,l,c,u,d,h,p,f,m=function(e,t){function n(){this.constructor=e}for(var i in t)g.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},g={}.hasOwnProperty;i=n(3),r=n(2),u=n(5),f=n(12),p=n(6),c=n(27).MainController,l=r.Radio.channel("global"),h=r.Radio.channel("resources"),d=r.Radio.channel("messages"),s={html:"Document",markdown:"MarkDownDocument"},o={Document:"html",MarkDownDocument:"markdown"},a=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return m(t,e),t.prototype._get_doc_and_render_view=function(e){var t;return t=this.current_resource.fetch(),t.done(function(t){return function(){var n,i,r;return l.request("make-editbar",t.current_resource),l.request("make-breadcrumbs",t.current_resource),r=new e({model:t.current_resource}),"AceEditorView"===e.name&&(n=t.current_resource.get("data"),i=n.type,("Document"===i||"MarkDownDocument"===i)&&(r.editorMode="ace/mode/"+o[i])),t._show_content(r)}}(this))},t.prototype._get_contents_and_render_view=function(e){return n.e(0,function(t){return function(){var i,r;return i=n(30),t._set_resource(e),r=t.current_resource.fetch(),r.done(function(){var n,r;return n=h.request("get-document-contents",e),r=n.fetch(),r.done(function(){var e;return l.request("make-editbar",t.current_resource),l.request("make-breadcrumbs",t.current_resource),e=new i.ContentsView({model:t.current_resource,collection:n}),t._show_content(e)})})}}(this))},t.prototype.manage_contents=function(e){return this._get_contents_and_render_view(e)},t.prototype._add_document=function(e,t){return"html"!==e&&"markdown"!==e&&console.error("I don't understand "+e),n.e(0,function(r){return function(){var o,a,l,c;return o=n(10),a=n(30),null===t&&(t=""),l=new o.BaseKottiResource,l.url=t+"/@@json",l.content_type=s[e],c=new a.NewDocumentView({model:l}),c.editorMode="ace/mode/"+e,window.newdocview=c,r._show_content(c),i("title").text("Add new "+e+" document to "+t)}}(this))},t.prototype.add_node=function(e,t){var n;return this._set_resource(t),n=this.current_resource.fetch(),n.done(function(n){return function(){var i;return l.request("make-editbar",n.current_resource),l.request("make-breadcrumbs",n.current_resource),"document"===e?n._add_document("html",t):"markdown"===e?n._add_document("markdown",t):(i="Unable to add type "+e,d.request("display-message",i,"error"))}}(this))},t.prototype.hallo_edit_node=function(e){return n.e(0,function(t){return function(){var i;return i=n(30),t._set_resource(e),t._get_doc_and_render_view(i.EditorView)}}(this))},t.prototype.ace_edit_node=function(e){return n.e(0,function(t){return function(){var i;return i=n(30),t._set_resource(e),t._get_doc_and_render_view(i.AceEditorView)}}(this))},t}(c),e.exports=a},94:function(e,t,n){var i,r,o,s,a,l,c,u,d,h,p=function(e,t){function n(){this.constructor=e}for(var i in t)f.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},f={}.hasOwnProperty;r=n(2),l=n(5),h=n(6),o=n(26),s=n(93),a=r.Radio.channel("global"),c=r.Radio.channel("messages"),u=r.Radio.channel("resources"),i=r.Radio.channel("editcontents"),d=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return p(t,e),t.prototype.appRoutes={"editor/contents":"manage_contents","editor/contents/*resource":"manage_contents","editor/edit":"ace_edit_node","editor/edit/*resource":"ace_edit_node","editor/ace-edit":"ace_edit_node","editor/ace-edit/*resource":"ace_edit_node","editor/hallo-edit":"hallo_edit_node","editor/hallo-edit/*resource":"hallo_edit_node","editor/addnode":"add_node","editor/addnode/*resource":"add_node","editor/add_:content_type":"add_node","editor/add_:content_type/*resource":"add_node"},t}(o),a.reply("applet:editcontents:route",function(){var e,t;return e=new s(a),e.current_resource=u.request("current-document"),t=new d({controller:e}),i.reply("contents-changed",function(t){return function(){return e.manage_contents(e.resource_id)}}(this))})},95:function(e,t,n){var i,r,o,s,a,l,c,u,d,h,p=function(e,t){function n(){this.constructor=e}for(var i in t)f.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},f={}.hasOwnProperty;i=n(3),r=n(2),l=n(5),h=n(12),a=n(27).MainController,s=r.Radio.channel("global"),c=r.Radio.channel("messages"),u=r.Radio.channel("resources"),d=n(98),o=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return p(t,e),t.prototype.make_main_content=function(){var e;return s.request("make-editbar",this.current_resource),e=new d.FrontDoorMainView({model:this.current_resource}),this._show_content(e)},t.prototype._view_resource=function(){var e;return e=this.current_resource.fetch(),e.done(function(e){return function(){var t,n,r,o;return s.request("make-editbar",e.current_resource),t=e.current_resource.get("data"),n=e.current_resource.get("meta"),o="folder_view"===n.default_view?d.FrontDoorMainView:d.FrontDoorMainView,r=new o({model:e.current_resource}),e._show_content(r),i("title").text(t.attributes.title),s.request("make-breadcrumbs",e.current_resource)}}(this))},t.prototype.view_resource=function(e){return this._set_resource(e),this._view_resource()},t.prototype.frontdoor=function(){return this._view_resource()},t.prototype.start=function(){return this.make_main_content()},t}(a),e.exports=o},96:function(e,t,n){var i,r,o,s,a,l,c,u,d,h=function(e,t){function n(){this.constructor=e}for(var i in t)p.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},p={}.hasOwnProperty;i=n(2),a=n(5),d=n(6),r=n(26),o=n(95),s=i.Radio.channel("global"),l=i.Radio.channel("messages"),c=i.Radio.channel("resources"),u=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return h(t,e),t.prototype.appRoutes={"":"view_resource",frontdoor:"view_resource","frontdoor/view":"view_resource","frontdoor/view/*resource":"view_resource"},t}(r),s.reply("applet:frontdoor:route",function(){var e,t;return e=new o(s),e.current_resource=c.request("current-document"),t=new u({controller:e})})},97:function(e,t,n){var i,r,o,s,a,l,c,u,d,h;h=n(8),c=n(12),d=n(11),u=d.navbar_collapse_button,o=d.dropdown_toggle,l=d.frontdoor_url,s=d.editor_url,a=h.renderable(function(e){return h.raw(e.data.attributes.body)}),i=h.renderable(function(e){var t,n;return t=e.data.attributes,n=e.data.type,h.article(".document-view.content",function(){return h.h1(t.title),h.p(".lead",t.description),h.div(".body",function(){return"Document"===n?h.raw(t.body):"MarkDownDocument"===n?h.raw(c(t.body)):console.warn("Don't know how to render "+n)})})}),r=h.renderable(function(e){var t,n;return t=e.data.attributes,n=e.data.relationships.meta,h.article(".document-view.content",function(){return h.h1(t.title),h.p(".lead",t.description),h.h2("Contents"),h.div(".body",function(){return h.table(".table.table-condensed",function(){return h.thead(function(){return h.tr(function(){return h.th("Title"),h.th("Type"),h.th("Creation Date"),h.th("Modification Date")})}),h.tbody(function(){var e,t,i,r,o,s,a;for(o=n.children,s=[],i=0,r=o.length;r>i;i++)e=o[i],a=e.data.relationships.meta.type_info,t=l(e.path),s.push(h.tr(function(){return h.td(function(){return h.a({href:t},e.data.attributes.title)}),h.td(function(){return h.a({href:t},a.title)}),h.td(function(){return h.a({href:t},e.meta.creation_date)}),h.td(function(){return h.a({href:t},e.meta.modification_date)})}));return s})})})})}),e.exports={frontdoor_main:a,DefaultViewTemplate:i,FolderViewTemplate:r}},98:function(e,t,n){var i,r,o,s,a,l,c,u,d,h,p=function(e,t){function n(){this.constructor=e}for(var i in t)f.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},f={}.hasOwnProperty;i=n(2),l=n(5),r=n(97),h=n(29),u=n(6),d=u.remove_trailing_slashes,c=u.make_json_post,n(25),a=i.Radio.channel("global"),s=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return p(t,e),t.prototype.template=r.DefaultViewTemplate,t.prototype.onDomRefresh=function(){return $(".ui-draggable").draggable()},t}(i.Marionette.ItemView),o=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return p(t,e),t.prototype.template=r.FolderViewTemplate,t}(i.Marionette.ItemView),e.exports={FrontDoorMainView:s,FolderView:o}},99:function(e,t,n){var i,r,o,s,a,l,c,u,d,h,p,f,m=function(e,t){function n(){this.constructor=e}for(var i in t)g.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},g={}.hasOwnProperty;i=n(3),o=n(2),c=n(5),p=n(6),l=n(27).MainController,f=n(102),d=n(10),a=o.Radio.channel("global"),h=o.Radio.channel("resources"),u=o.Radio.channel("messages"),r=o.Radio.channel("setupusers"),s=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return m(t,e),t.prototype._update_views_common=function(){return a.request("make-editbar",this.current_resource),a.request("make-breadcrumbs",this.current_resource),this._setup_dashboard()},t.prototype._setup_dashboard=function(){var e,t;return e=this._get_region("content"),e.currentView instanceof f.DashboardView?void 0:(t=new f.DashboardView,this._show_content(t),this.layout=t)},t.prototype.setup_users=function(){var e,t;return this._update_views_common(),t=new f.SearchUsersView,e=this.layout.regionManager.get("searchform"),e.show(t)},t.prototype.display_search_results=function(e){var t,n,i;return this._update_views_common(),t=new o.Model(e),i=new f.SearchResultsView({model:t}),n=this.layout.regionManager.get("usercontent"),n.show(i)},t}(l),e.exports=s},100:function(e,t,n){var i,r,o,s,a,l,c,u,d,h,p=function(e,t){function n(){this.constructor=e}for(var i in t)f.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},f={}.hasOwnProperty;r=n(2),l=n(5),h=n(6),o=n(26),s=n(99),a=r.Radio.channel("global"),c=r.Radio.channel("messages"),u=r.Radio.channel("resources"),i=r.Radio.channel("setupusers"),d=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return p(t,e),t.prototype.appRoutes={setupusers:"setup_users","setupusers/":"setup_users"},t}(o),a.reply("applet:setupusers:route",function(){var e,t;return e=new s(a),e.current_resource=u.request("current-document"),t=new d({controller:e}),i.reply("search-results-returned",function(t){return function(t){return e.display_search_results(t)}}(this))})},101:function(e,t,n){var i,r,o,s,a,l,c,u,d,h,p,f,m,g,v,b,y,w,_,k,x,E=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};_=n(8),u=n(12),p=n(19),d=p.navbar_collapse_button,s=p.dropdown_toggle,f=n(11),c=f.frontdoor_url,a=f.editor_url,x=n(44).workflow_dropdown,l=n(72).form_group_input_div,r=n(73).ace_editor_div,m=n(6),o=m.capitalize,w=m.str_startswith,i=Backbone.Radio.channel("global"),k=_.renderable(function(){return _.div(".row",function(){return _.div("#useradmin-sidebar.col-md-3.left-column.panel.panel-default",function(){return _.span(".label.label-primary","Search Users/Groups"),_.div("#useradmin-search-form"),_.div(".form-group",function(){return _.div(".label.label-primary","Add Users/Groups"),_.div("#adduser-btn.form-control.btn.btn-default",function(){return _.text("Add User")}),_.div("#addgroup-btn..form-control.btn.btn-default",function(){return _.text("Add Group")})})}),_.div("#useradmin-content.col-md-9.right-column")})}),y=_.renderable(function(e){return _.ul(".nav.nav-tabs",function(){return _.li(".active",function(){return _.a({href:"#search-tab","data-toggle":"tab"},function(){return"Search users(s) / group(s)"})}),_.li(function(){return _.a({href:"#add-user-tab","data-toggle":"tab"},function(){return"Add user"})}),_.li(function(){return _.a({href:"#add-group-tab","data-toggle":"tab"},function(){return"Add group"})})})}),g=_.renderable(function(e){return _.div("#search-tab.tab-pane",function(){return _.div(".panel.panel-default",{style:"margin-top:2em;"},function(){return _.div(".panel-heading",function(){return _.h3(".panel-title","Find users or groups")}),_.div(".panel-body",function(){return _.form(".form",function(){return _.div(".control-group",function(){return _.label({"for":"search-query"},"User- / groupname"),_.input("#search-query.form-control",{type:"search",name:"query",placeholder:"Search users and groups"}),_.span(".help-block","blank search text finds all.")}),_.button(".btn.btn-primary",{type:"submit",name:"search"},function(){return _.i(".glyphicon.glyphicon-search"),_.span("Search")})})})})})}),b=_.renderable(function(e){return l({input_id:"input_query",label:"Name",input_attributes:{name:"query"}}),_.input(".btn.btn-primary",{type:"submit",value:"search"})}),h=_.renderable(function(e,t){var n,i,r;return r=e.principal,n=!r.name.indexOf("group:"),
n=w(r.name,"group:"),i=!n,_.tr(function(){var i,o,s,a;for(_.td(function(){return _.span(function(){return n?"Group":"User"})}),_.td(function(){return _.img({src:r.avatar_url,alt:"Gravatar"}),_.a({href:"#setupusers/user/"+r.name},r.title),(null!=r?r.email:void 0)?_.div("<"+r.email+">"):void 0}),s=[],i=0,o=t.length;o>i;i++)a=t[i],s.push(_.td(function(){var t,n,i,o;return t={type:"checkbox",title:"Assign role "+a.name},n=a.name,E.call(e.enabled,n)>=0&&(t.checked="checked"),i=a.name,E.call(e.disabled,i)>=0&&(t.disabled="disabled"),_.input(t),t={type:"hidden",name:"orig-role::"+r.name+"::"+a.name,value:(o=a.name,E.call(e.enabled,o)>=0?"1":"")},_.input(t)}));return s})}),v=_.renderable(function(e){return _.h2("Assign global roles"),_.table(".table.table-bordered.table-hover",function(){return _.thead(function(){return _.tr(function(){var t,n,i,r,o;for(_.th("Type"),_.th("Name"),i=e.available_roles,r=[],t=0,n=i.length;n>t;t++)o=i[t],r.push(_.th(o.title));return r})}),_.tbody(function(){var t,n,i,r,o;for(r=e.entries,o=[],n=0,i=r.length;i>n;n++)t=r[n],o.push(h(t,e.available_roles));return o})}),_.div(".btn.btn-primary",{type:"submit",value:"apply"},function(){return _.i(".glyphicon.glyphicon-save"),_.span("Apply changes")})}),e.exports={user_admin_dashboard:k,search_users_form:b,search_results_form:v}},102:function(e,t,n){var i,r,o,s,a,l,c,u,d,h,p,f,m,g,v=function(e,t){function n(){this.constructor=e}for(var i in t)b.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},b={}.hasOwnProperty;o=n(2),c=n(5),n(25),g=n(29),r=n(101),f=n(6),m=f.remove_trailing_slashes,p=f.make_json_post,u=n(10),l=o.Radio.channel("global"),i=o.Radio.channel("setupusers"),s=n(71),a=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return v(t,e),t.prototype.template=r.user_admin_dashboard,t.prototype.regions={searchform:"#useradmin-search-form",userbar:"#useradmin-sidebar",usercontent:"#useradmin-content"},t}(o.Marionette.LayoutView),h=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return v(t,e),t.prototype.template=r.search_users_form,t.prototype.ui={query:'input[name="query"]'},t.prototype.createModel=function(){var e;return new(e=l.request("base-kotti-model"))},t.prototype.updateModel=function(){return this.model.url="/@@setup-users-json",this.model.set("query",this.ui.query.val()),this.model.set("search","")},t.prototype.saveModel=function(){var e;return e={success:function(e){return function(t,n){return e.onSuccess(e.model,n)}}(this),error:function(e){return function(){return e.trigger("save:form:failure",e.model)}}(this)},this.model.save({},e)},t.prototype.onSuccess=function(e,t){return this.render(),i.request("search-results-returned",t.data)},t}(s),d=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return v(t,e),t.prototype.template=r.search_results_form,t.prototype._baseUI=function(){return{submit:'div[type="submit"]',activityIndicator:".spinner"}},t.prototype.createModel=function(){return this.model},t.prototype.updateModel=function(){return window.fview=this},t}(s),e.exports={DashboardView:a,SearchUsersView:h,SearchResultsView:d}},103:function(e,t,n){var i,r,o,s,a,l,c,u,d,h=function(e,t){function n(){this.constructor=e}for(var i in t)p.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},p={}.hasOwnProperty;i=n(2),l=n(5),o=n(44),d=n(48),s=n(46),u=n(47),a=i.Radio.channel("global"),c=i.Radio.channel("messages"),r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return h(t,e),t.prototype.template=o.editor_bar_pt,t}(i.Marionette.LayoutView),e.exports={EditBarView:r}},111:function(e,t,n){var i,r,o,s,a=function(e,t){return function(){return e.apply(t,arguments)}},l=function(e,t){function n(){this.constructor=e}for(var i in t)c.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},c={}.hasOwnProperty;s=n(4),r=n(5),o=n(76),i=function(e){function t(){this.invalid=a(this.invalid,this),this.valid=a(this.valid,this),t.__super__.constructor.apply(this,arguments),this.listenTo(this,"render",this.hideActivityIndicator),this.listenTo(this,"render",this.prepareModel),this.listenTo(this,"save:form:success",this.success),this.listenTo(this,"save:form:failure",this.failure)}return l(t,e),t.prototype.delegateEvents=function(e){return this.ui=s.extend(this._baseUI(),s.result(this,"ui")),this.events=s.extend(this._baseEvents(),s.result(this,"events")),t.__super__.delegateEvents.call(this,e)},t.prototype.tagName="form",t.prototype._baseUI=function(){return{submit:'input[type="submit"]',activityIndicator:".spinner"}},t.prototype._baseEvents=function(){var e;return e={"change [data-validation]":this.validateField,"blur [data-validation]":this.validateField,"keyup [data-validation]":this.validateField},e["click "+this.ui.submit]=this.processForm,e},t.prototype.createModel=function(){throw new Error("implement #createModel in your FormView subclass to return a Backbone model")},t.prototype.prepareModel=function(){return this.model=this.createModel(),this.setupValidation()},t.prototype.validateField=function(e){var t,n;return t=$(e.target).attr("data-validation"),n=$(e.target).val(),this.model.preValidate(t,n)?this.invalid(this,t):this.valid(this,t)},t.prototype.processForm=function(e){return e.preventDefault(),this.showActivityIndicator(),this.updateModel(),this.saveModel()},t.prototype.updateModel=function(){throw new Error("implement #updateModel in your FormView subclass to update the attributes of @model")},t.prototype.saveModel=function(){var e;return e={success:function(e){return function(){return e.trigger("save:form:success",e.model)}}(this),error:function(e){return function(){return e.trigger("save:form:failure",e.model)}}(this)},this.model.save({},e)},t.prototype.success=function(e){return this.render(),this.onSuccess(e)},t.prototype.onSuccess=function(e){return null},t.prototype.failure=function(e){return this.hideActivityIndicator(),this.onFailure(e)},t.prototype.onFailure=function(e){return null},t.prototype.showActivityIndicator=function(){return this.ui.activityIndicator.show(),this.ui.submit.hide()},t.prototype.hideActivityIndicator=function(){return this.ui.activityIndicator.hide(),this.ui.submit.show()},t.prototype.setupValidation=function(){return Backbone.Validation.unbind(this),Backbone.Validation.bind(this,{valid:this.valid,invalid:this.invalid})},t.prototype.valid=function(e,t,n){return this.$("[data-validation="+t+"]").removeClass("invalid").addClass("valid")},t.prototype.invalid=function(e,t,n,i){return this.failure(this.model),this.$("[data-validation="+t+"]").removeClass("valid").addClass("invalid")},t}(Backbone.Marionette.ItemView),e.exports=i}});
//# sourceMappingURL=dashboard-5819ed7b13643ac89a7e.js.map