webpackJsonp([2],[function(e,t,n){var i,r,o,s,a,l,c,u,h,d,p,f,m,g,v,b,y,w=function(e,t){function n(){this.constructor=e}for(var i in t)_.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},_={}.hasOwnProperty;p=n(3),r=n(2),a=n(5),n(44),n(43),c=n(16),d=n(31),i=n(86),n(87),h=n(8),n(91),n(89),n(95),s=r.Radio.channel("global"),l=r.Radio.channel("messages"),u=r.Radio.channel("resources"),r.Radio.DEBUG=!0,o=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return w(t,e),t.prototype.el="#modal",t.prototype.getEl=function(e){var t;return t=$(e),t.attr("class","modal"),t},t.prototype.show=function(e){return t.__super__.show.call(this,e),this.$el.modal({backdrop:!1}),this.$el.modal("show")},t}(r.Marionette.Region),v=function(e,t){var n,i,r,o;return o=s.request("main:app:regions"),n=s.request("main:app:appmodel"),i=new d.MainPageLayout,i.on("show",function(e){return function(){var e,n,i,r;return i=new d.BootstrapNavBarView({model:t}),r=o.get("navbar"),r.show(i),e=new d.MessagesView({collection:l.request("messages")}),n=o.get("messages"),n.show(e)}}(this)),r=o.get("mainview"),r.show(i)},b=function(e,t,n){var i,a,l;return l=t.get("regions"),"modal"in l&&(l.modal=o),a=new r.Marionette.RegionManager,a.addRegions(l),i=a.get("navbar"),i.on("show",function(e){return function(){return s.trigger("appregion:navbar:displayed")}}(this)),s.reply("main:app:object",function(){return e}),s.reply("main:app:regions",function(){return a}),s.reply("main:app:get-region",function(e){return a.get(e)}),e.on("start",function(){var e,i,o,a,l,c;for(i=t.get("frontdoor_app"),s.request("applet:"+i+":route"),l=t.get("applets"),o=0,a=l.length;a>o;o++)e=l[o],c="applet:"+e.appname+":route",s.request(c);return s.request("mainpage:init",t,n),r.history.started?void 0:r.history.start()})},s.reply("main:app:appmodel",function(){return i}),s.reply("mainpage:init",function(e){return function(e,t){var n;return n=s.request("main:app:object"),v(n,t),s.trigger("mainpage:displayed")}}(this)),s.on("appregion:navbar:displayed",function(){var e,t;return t=new d.MainSearchFormView({model:u.request("current-document")}),e=s.request("main:app:get-region","search"),e.show(t)}),f=new a.Application,window.App=f,g=location.pathname,h.str_endswith(g,"@@dashboard")&&(g=g.split("@@dashboard")[0]),"/"===g&&(g=""),m=u.request("get-document",g),u.reply("current-document",function(){return m}),window.current_doc=m,y=m.fetch(),y.done(function(){var e;return b(f,i,m),f.start(),e=m.get("data"),$("title").text(e.attributes.title)}),e.exports=f},,,,,,,,function(e,t,n){var i,r,o,s,a,l,c,u,h,d,p,f,m,g;i=n(4),o=n(3),r=n(2),f=function(){return i("html, body").animate({scrollTop:0},"fast")},d=function(e){var t;return""===e.split("/")[0]?window.location=e:(t=new r.Router,t.navigate(e,{trigger:!0}))},a=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},l=function(e){return e.replace(/(?:\r\n|\r|\n)/g,"<br />")},s=function(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})},h=function(e){var t,n,r,o,s,a,l;for(s=e.split("/")[0],a=i("#app-navbar li"),l=[],t=0,n=a.length;n>t;t++)r=a[t],o=i(r),o.removeClass("active"),s===o.attr("appname")?l.push(o.addClass("active")):l.push(void 0);return l},u=function(e,t,n){var i;return null==n&&(n="POST"),i={type:n,url:e,data:JSON.stringify(t),accepts:"application/json",contentType:"application/json"}},c=function(e,t,n){var r;return null==n&&(n="POST"),r=u(e,t,n),i.ajax(r)},p=function(e){return e.replace(/\/$/,"")},g=function(e,t){return!e.indexOf(t)},m=function(e,t){return-1!==e.indexOf(t,e.length-t.length)},e.exports={scroll_top_fast:f,navigate_to_url:d,capitalize:a,handle_newlines:l,camel_to_kebab:s,navbar_set_active:h,make_json_post_settings:u,make_json_post:c,remove_trailing_slashes:p,str_startswith:g,str_endswith:m}},,,,,,,,function(e,t,n){var i,r,o,s,a,l,c,u,h,d,p,f,m,g,v,b,y=function(e,t){function n(){this.constructor=e}for(var i in t)w.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},w={}.hasOwnProperty;i=n(4),g=n(3),o=n(2),p=n(5),d=o.Radio.channel("global"),f=o.Radio.channel("messages"),m=o.Radio.channel("resources"),s=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return y(t,e),t.prototype.parse=function(e,n){var i,r,o,s,a,l;s=e.meta.messages;for(r in s)for(l=s[r],i=0,o=l.length;o>i;i++)a=l[i],f.request("display-message",a,r);return t.__super__.parse.call(this,e,n)},t}(o.Model),d.reply("base-kotti-model",function(){return s}),c=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return y(t,e),t.prototype.defaults={level:"info"},t}(o.Model),u=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return y(t,e),t.prototype.model=c,t}(o.Collection),a=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return y(t,e),t.prototype.url=function(){return this.id+"/@@json"},t.prototype.parse=function(e,n){return e.oid=e.data.attributes.oid,t.__super__.parse.call(this,e,n)},t}(s),r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return y(t,e),t.prototype.id="ittok",t}(o.Model),h=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return y(t,e),t.prototype.url="@@json",t}(s),l=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return y(t,e),t}(o.Model),v=new r,d.reply("main:app:settings",function(){return v}),m.reply("get-document",function(e){return new a({id:e})}),b=new u,f.reply("messages",function(){return b}),f.reply("display-message",function(e){return function(e,t){var n;return n=new o.Model({content:e,level:t}),b.add(n)}}(this)),f.reply("delete-message",function(e){return function(e){var t;return t=f.request("messages"),t.remove(e)}}(this)),e.exports={BaseKottiModel:s,BaseKottiResource:a,KottiMessage:c,AppSettings:r,KottiRootDocument:h}},function(e,t,n){var i,r,o,s,a;i=n(4),r=n(3),a=n(9),s=function(e){var t;return t=e.replace(/\/$/,""),"#frontdoor/view"+t},o=function(e,t){var n,i;return i=t.replace(/\/$/,""),n=i.replace(/^\//,""),"#editor/"+e+"/"+n},e.exports={frontdoor_url:s,editor_url:o}},function(e,t,n){(function(t){(function(){function t(e){this.tokens=[],this.tokens.links={},this.options=e||u.defaults,this.rules=h.normal,this.options.gfm&&(this.options.tables?this.rules=h.tables:this.rules=h.gfm)}function n(e,t){if(this.options=t||u.defaults,this.links=e,this.rules=d.normal,this.renderer=this.options.renderer||new i,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=d.breaks:this.rules=d.gfm:this.options.pedantic&&(this.rules=d.pedantic)}function i(e){this.options=e||{}}function r(e){this.tokens=[],this.token=null,this.options=e||u.defaults,this.options.renderer=this.options.renderer||new i,this.renderer=this.options.renderer,this.renderer.options=this.options}function o(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function s(e){return e.replace(/&([#\w]+);/g,function(e,t){return t=t.toLowerCase(),"colon"===t?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""})}function a(e,t){return e=e.source,t=t||"",function n(i,r){return i?(r=r.source||r,r=r.replace(/(^|[^\[])\^/g,"$1"),e=e.replace(i,r),n):new RegExp(e,t)}}function l(){}function c(e){for(var t,n,i=1;i<arguments.length;i++){t=arguments[i];for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}function u(e,n,i){if(i||"function"==typeof n){i||(i=n,n=null),n=c({},u.defaults,n||{});var s,a,l=n.highlight,h=0;try{s=t.lex(e,n)}catch(d){return i(d)}a=s.length;var p=function(e){if(e)return n.highlight=l,i(e);var t;try{t=r.parse(s,n)}catch(o){e=o}return n.highlight=l,e?i(e):i(null,t)};if(!l||l.length<3)return p();if(delete n.highlight,!a)return p();for(;h<s.length;h++)!function(e){return"code"!==e.type?--a||p():l(e.text,e.lang,function(t,n){return t?p(t):null==n||n===e.text?--a||p():(e.text=n,e.escaped=!0,void(--a||p()))})}(s[h])}else try{return n&&(n=c({},u.defaults,n)),r.parse(t.lex(e,n),n)}catch(d){if(d.message+="\nPlease report this to https://github.com/chjj/marked.",(n||u.defaults).silent)return"<p>An error occured:</p><pre>"+o(d.message+"",!0)+"</pre>";throw d}}var h={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:l,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:l,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:l,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};h.bullet=/(?:[*+-]|\d+\.)/,h.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,h.item=a(h.item,"gm")(/bull/g,h.bullet)(),h.list=a(h.list)(/bull/g,h.bullet)("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?="+h.def.source+")")(),h.blockquote=a(h.blockquote)("def",h.def)(),h._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b",h.html=a(h.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,h._tag)(),h.paragraph=a(h.paragraph)("hr",h.hr)("heading",h.heading)("lheading",h.lheading)("blockquote",h.blockquote)("tag","<"+h._tag)("def",h.def)(),h.normal=c({},h),h.gfm=c({},h.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\s*\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),h.gfm.paragraph=a(h.paragraph)("(?!","(?!"+h.gfm.fences.source.replace("\\1","\\2")+"|"+h.list.source.replace("\\1","\\3")+"|")(),h.tables=c({},h.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),t.rules=h,t.lex=function(e,n){var i=new t(n);return i.lex(e)},t.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},t.prototype.token=function(e,t,n){for(var i,r,o,s,a,l,c,u,d,e=e.replace(/^ +$/gm,"");e;)if((o=this.rules.newline.exec(e))&&(e=e.substring(o[0].length),o[0].length>1&&this.tokens.push({type:"space"})),o=this.rules.code.exec(e))e=e.substring(o[0].length),o=o[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?o:o.replace(/\n+$/,"")});else if(o=this.rules.fences.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"code",lang:o[2],text:o[3]||""});else if(o=this.rules.heading.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"heading",depth:o[1].length,text:o[2]});else if(t&&(o=this.rules.nptable.exec(e))){for(e=e.substring(o[0].length),l={type:"table",header:o[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:o[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:o[3].replace(/\n$/,"").split("\n")},u=0;u<l.align.length;u++)/^ *-+: *$/.test(l.align[u])?l.align[u]="right":/^ *:-+: *$/.test(l.align[u])?l.align[u]="center":/^ *:-+ *$/.test(l.align[u])?l.align[u]="left":l.align[u]=null;for(u=0;u<l.cells.length;u++)l.cells[u]=l.cells[u].split(/ *\| */);this.tokens.push(l)}else if(o=this.rules.lheading.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"heading",depth:"="===o[2]?1:2,text:o[1]});else if(o=this.rules.hr.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"hr"});else if(o=this.rules.blockquote.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"blockquote_start"}),o=o[0].replace(/^ *> ?/gm,""),this.token(o,t,!0),this.tokens.push({type:"blockquote_end"});else if(o=this.rules.list.exec(e)){for(e=e.substring(o[0].length),s=o[2],this.tokens.push({type:"list_start",ordered:s.length>1}),o=o[0].match(this.rules.item),i=!1,d=o.length,u=0;d>u;u++)l=o[u],c=l.length,l=l.replace(/^ *([*+-]|\d+\.) +/,""),~l.indexOf("\n ")&&(c-=l.length,l=this.options.pedantic?l.replace(/^ {1,4}/gm,""):l.replace(new RegExp("^ {1,"+c+"}","gm"),"")),this.options.smartLists&&u!==d-1&&(a=h.bullet.exec(o[u+1])[0],s===a||s.length>1&&a.length>1||(e=o.slice(u+1).join("\n")+e,u=d-1)),r=i||/\n\n(?!\s*$)/.test(l),u!==d-1&&(i="\n"===l.charAt(l.length-1),r||(r=i)),this.tokens.push({type:r?"loose_item_start":"list_item_start"}),this.token(l,!1,n),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(o=this.rules.html.exec(e))e=e.substring(o[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===o[1]||"script"===o[1]||"style"===o[1]),text:o[0]});else if(!n&&t&&(o=this.rules.def.exec(e)))e=e.substring(o[0].length),this.tokens.links[o[1].toLowerCase()]={href:o[2],title:o[3]};else if(t&&(o=this.rules.table.exec(e))){for(e=e.substring(o[0].length),l={type:"table",header:o[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:o[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:o[3].replace(/(?: *\| *)?\n$/,"").split("\n")},u=0;u<l.align.length;u++)/^ *-+: *$/.test(l.align[u])?l.align[u]="right":/^ *:-+: *$/.test(l.align[u])?l.align[u]="center":/^ *:-+ *$/.test(l.align[u])?l.align[u]="left":l.align[u]=null;for(u=0;u<l.cells.length;u++)l.cells[u]=l.cells[u].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(l)}else if(t&&(o=this.rules.paragraph.exec(e)))e=e.substring(o[0].length),this.tokens.push({type:"paragraph",text:"\n"===o[1].charAt(o[1].length-1)?o[1].slice(0,-1):o[1]});else if(o=this.rules.text.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"text",text:o[0]});else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var d={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:l,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:[^_]|__)+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:l,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};d._inside=/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,d._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,d.link=a(d.link)("inside",d._inside)("href",d._href)(),d.reflink=a(d.reflink)("inside",d._inside)(),d.normal=c({},d),d.pedantic=c({},d.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),d.gfm=c({},d.normal,{escape:a(d.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:a(d.text)("]|","~]|")("|","|https?://|")()}),d.breaks=c({},d.gfm,{br:a(d.br)("{2,}","*")(),text:a(d.gfm.text)("{2,}","*")()}),n.rules=d,n.output=function(e,t,i){var r=new n(t,i);return r.output(e)},n.prototype.output=function(e){for(var t,n,i,r,s="";e;)if(r=this.rules.escape.exec(e))e=e.substring(r[0].length),s+=r[1];else if(r=this.rules.autolink.exec(e))e=e.substring(r[0].length),"@"===r[2]?(n=":"===r[1].charAt(6)?this.mangle(r[1].substring(7)):this.mangle(r[1]),i=this.mangle("mailto:")+n):(n=o(r[1]),i=n),s+=this.renderer.link(i,null,n);else if(this.inLink||!(r=this.rules.url.exec(e))){if(r=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(r[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(r[0])&&(this.inLink=!1),e=e.substring(r[0].length),s+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):o(r[0]):r[0];else if(r=this.rules.link.exec(e))e=e.substring(r[0].length),this.inLink=!0,s+=this.outputLink(r,{href:r[2],title:r[3]}),this.inLink=!1;else if((r=this.rules.reflink.exec(e))||(r=this.rules.nolink.exec(e))){if(e=e.substring(r[0].length),t=(r[2]||r[1]).replace(/\s+/g," "),t=this.links[t.toLowerCase()],!t||!t.href){s+=r[0].charAt(0),e=r[0].substring(1)+e;continue}this.inLink=!0,s+=this.outputLink(r,t),this.inLink=!1}else if(r=this.rules.strong.exec(e))e=e.substring(r[0].length),s+=this.renderer.strong(this.output(r[2]||r[1]));else if(r=this.rules.em.exec(e))e=e.substring(r[0].length),s+=this.renderer.em(this.output(r[2]||r[1]));else if(r=this.rules.code.exec(e))e=e.substring(r[0].length),s+=this.renderer.codespan(o(r[2],!0));else if(r=this.rules.br.exec(e))e=e.substring(r[0].length),s+=this.renderer.br();else if(r=this.rules.del.exec(e))e=e.substring(r[0].length),s+=this.renderer.del(this.output(r[1]));else if(r=this.rules.text.exec(e))e=e.substring(r[0].length),s+=this.renderer.text(o(this.smartypants(r[0])));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}else e=e.substring(r[0].length),n=o(r[1]),i=n,s+=this.renderer.link(i,null,n);return s},n.prototype.outputLink=function(e,t){var n=o(t.href),i=t.title?o(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(n,i,this.output(e[1])):this.renderer.image(n,i,o(e[1]))},n.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014\/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014\/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):e},n.prototype.mangle=function(e){if(!this.options.mangle)return e;for(var t,n="",i=e.length,r=0;i>r;r++)t=e.charCodeAt(r),Math.random()>.5&&(t="x"+t.toString(16)),n+="&#"+t+";";return n},i.prototype.code=function(e,t,n){if(this.options.highlight){var i=this.options.highlight(e,t);null!=i&&i!==e&&(n=!0,e=i)}return t?'<pre><code class="'+this.options.langPrefix+o(t,!0)+'">'+(n?e:o(e,!0))+"\n</code></pre>\n":"<pre><code>"+(n?e:o(e,!0))+"\n</code></pre>"},i.prototype.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},i.prototype.html=function(e){return e},i.prototype.heading=function(e,t,n){return"<h"+t+' id="'+this.options.headerPrefix+n.toLowerCase().replace(/[^\w]+/g,"-")+'">'+e+"</h"+t+">\n"},i.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},i.prototype.list=function(e,t){var n=t?"ol":"ul";return"<"+n+">\n"+e+"</"+n+">\n"},i.prototype.listitem=function(e){return"<li>"+e+"</li>\n"},i.prototype.paragraph=function(e){return"<p>"+e+"</p>\n"},i.prototype.table=function(e,t){return"<table>\n<thead>\n"+e+"</thead>\n<tbody>\n"+t+"</tbody>\n</table>\n"},i.prototype.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},i.prototype.tablecell=function(e,t){var n=t.header?"th":"td",i=t.align?"<"+n+' style="text-align:'+t.align+'">':"<"+n+">";return i+e+"</"+n+">\n"},i.prototype.strong=function(e){return"<strong>"+e+"</strong>"},i.prototype.em=function(e){return"<em>"+e+"</em>"},i.prototype.codespan=function(e){return"<code>"+e+"</code>"},i.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},i.prototype.del=function(e){return"<del>"+e+"</del>"},i.prototype.link=function(e,t,n){if(this.options.sanitize){try{var i=decodeURIComponent(s(e)).replace(/[^\w:]/g,"").toLowerCase()}catch(r){return""}if(0===i.indexOf("javascript:")||0===i.indexOf("vbscript:"))return""}var o='<a href="'+e+'"';return t&&(o+=' title="'+t+'"'),o+=">"+n+"</a>"},i.prototype.image=function(e,t,n){var i='<img src="'+e+'" alt="'+n+'"';return t&&(i+=' title="'+t+'"'),i+=this.options.xhtml?"/>":">"},i.prototype.text=function(e){return e},r.parse=function(e,t,n){var i=new r(t,n);return i.parse(e)},r.prototype.parse=function(e){this.inline=new n(e.links,this.options,this.renderer),this.tokens=e.reverse();for(var t="";this.next();)t+=this.tok();return t},r.prototype.next=function(){return this.token=this.tokens.pop()},r.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},r.prototype.parseText=function(){for(var e=this.token.text;"text"===this.peek().type;)e+="\n"+this.next().text;return this.inline.output(e)},r.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var e,t,n,i,r,o="",s="";for(n="",e=0;e<this.token.header.length;e++)i={header:!0,align:this.token.align[e]},n+=this.renderer.tablecell(this.inline.output(this.token.header[e]),{header:!0,align:this.token.align[e]});for(o+=this.renderer.tablerow(n),e=0;e<this.token.cells.length;e++){for(t=this.token.cells[e],n="",r=0;r<t.length;r++)n+=this.renderer.tablecell(this.inline.output(t[r]),{header:!1,align:this.token.align[r]});s+=this.renderer.tablerow(n)}return this.renderer.table(o,s);case"blockquote_start":for(var s="";"blockquote_end"!==this.next().type;)s+=this.tok();return this.renderer.blockquote(s);case"list_start":for(var s="",a=this.token.ordered;"list_end"!==this.next().type;)s+=this.tok();return this.renderer.list(s,a);case"list_item_start":for(var s="";"list_item_end"!==this.next().type;)s+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(s);case"loose_item_start":for(var s="";"list_item_end"!==this.next().type;)s+=this.tok();return this.renderer.listitem(s);case"html":var l=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(l);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}},l.exec=l,u.options=u.setOptions=function(e){return c(u.defaults,e),u},u.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,sanitizer:null,mangle:!0,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new i,xhtml:!1},u.Parser=r,u.parser=r.parse,u.Renderer=i,u.Lexer=t,u.lexer=t.lex,u.InlineLexer=n,u.inlineLexer=n.output,u.parse=u,e.exports=u}).call(function(){return this||("undefined"!=typeof window?window:t)}())}).call(t,function(){return this}())},,,,,,,,,function(e,t,n){var i,r,o,s,a,l,c,u,h,d,p,f,m,g,v,b,y,w;i=n(4),o=n(3),b=n(9),g=n(28),m=g.navbar_collapse_button,u=g.dropdown_toggle,v=n(17),f=v.frontdoor_url,p=v.editor_url,w=b.renderable(function(e){var t,n,i,r;return i=e.data.relationships.meta,r=i.workflow,b.li(".dropdown",function(){var e,t;return(null!=(e=r.current_state)?e.current:void 0)&&(null!=(t=i.has_permission)?t.state_change:void 0)?(u(function(){return b.span(".state-"+r.current_state.name,function(){return b.text(r.current_state.title),b.b(".caret")})}),b.ul(".dropdown-menu",function(){var e,t,n,i,o;for(n=r.transitions,i=[],e=0,t=n.length;t>e;e++)o=n[e],i.push(b.li(function(){return b.a({href:"#workflow-change"},function(){return b.text("Make "),b.span(r.states[o.to_state].title)})}));return i})):void 0}),(null!=(t=r.current_state)?t.current:void 0)&&!(null!=(n=i.has_permission)?n.state_change:void 0)?b.a(".state-"+r.current_state.name,function(){return b.text(r.current_state.title)}):void 0}),c=b.renderable(function(e){var t,n,i,r,o,s,a;for(o=e.data.relationships.meta,b.li(".divider"),b.li(".dropdown-header",{role:"presentation"},function(){return b.text("Set default view")}),r=o.selectable_default_views,s=[],n=0,i=r.length;i>n;n++)a=r[n],t={},a.is_current||(t.href="@@@set-default-view"),s.push(b.li(function(){return b.a(t,function(){return b.text(a.title),a.is_current?b.b(".glyphicon.glyphicon-ok.pull-right"):void 0})}));return s}),s=b.renderable(function(e){var t;return console.log("Actions_Dropdown",e.id,e),t=e.data.relationships.meta,b.li(".dropdown",function(){return u(function(){return b.span("Actions"),b.b(".caret")}),b.ul(".dropdown-menu",function(){var n,i,r,o;for(o=t.link_parent,n=0,i=o.length;i>n;n++)r=o[n],b.li(function(){return b.a({href:"#"},r.title)});return b.li(function(){return b.a({href:"#editor/aceedit"+e.id},"Ace Edit")}),c(e)})})}),a=b.renderable(function(e){var t,n;return n=e.data.relationships.meta,t=n.content_type_factories,b.li(".dropdown",function(){return u(function(){return b.span("Add"),b.b(".caret")}),b.ul(".dropdown-menu",function(){var e,i,r;for(i=0,r=t.length;r>i;i++)e=t[i],b.li(function(){var t;return t="#editor/"+e.command+e.resource,b.a({href:t},e.title)});return t?(b.li(".divider"),b.li(function(){return b.a({href:n.upload_url},"Upload Content")})):void 0})})}),y=b.renderable(function(e){var t,n;return t=e.data.relationships.meta,n=t.current_user,b.li(".dropdown.pull-right",function(){return u(function(){return b.text(n.title),b.b(".caret")}),b.ul("#user-dropdown.dropdown-menu",function(){var e,i,r,o;if(b.li(function(){return b.a({href:n.prefs_url},function(){return b.i(".fa.fa-gears.fa-fw"),b.span("Preferences")})}),t.has_permission.admin)for(b.li(".divider"),b.li(".dropdown-header",{role:"presentation"},function(){return b.text("Site Setup")}),b.li(function(){return b.a({href:"#setupusers"},"User Administration")}),o=t.site_setup_links,e=0,i=o.length;i>e;e++)r=o[e],b.li(function(){return b.a({href:r.url},r.title)});return b.li(function(){return b.a({href:"/@@logout"},function(){return b.i(".fa.fa-sign-out.fa-fw"),b.span("Logout")})})})})}),d=b.renderable(function(e){var t,n;return t=e.data.relationships.meta,n=t.paths.this_path,b.div(".container-fluid",function(){return b.div(".navbar-header",function(){return m("navbar-edit")}),b.div("#navbar-edit.collapse.navbar-collapse",function(){return b.ul(".nav.navbar-nav.navbar-left",function(){var i,r,o,l,c;for(t.has_permission.edit&&w(e),r="",t.request_url===t.api_url&&(r=".active"),b.li(function(){var e;return e=f(n),b.a({href:e},"View")}),c=t.edit_links,i=0,o=c.length;o>i;i++)l=c[i],b.li(function(){var e;return e=p(l.name,n),b.a({href:e},l.title)});return t.has_permission.edit&&s(e),t.has_permission.add?(b.li(".divider-vertical"),a(e)):void 0}),b.ul(".nav.navbar-nav.navbar-right",function(){var n;return n=".pull-right",t.request_url===t.navigate_url&&(n+=".active"),b.li(n,function(){return b.a({href:t.navigate_url},"Navigate")}),y(e)})})})}),h=b.renderable(function(e){return b.nav("#editor-bar.navbar.navbar-default.navbar-static-top",function(){return d(e)})}),r=b.renderable(function(){return b.div("#navbar-view-container"),b.div("#editor-bar-container"),b.div(".container",function(){return b.div("#breadcrumbs"),b.div(".row",function(){return b.div("#main-content.col-md-9"),b.div("#right-slot.col-md-3.right-column")})}),b.div("#footer"),b.div("#modal")}),l=b.renderable(function(e){var t;return t=e.data.relationships.meta,b.ol(".breadcrumb",function(){var e,n,i,r,o;for(b.small("You are here:  "),r=t.breadcrumbs,o=[],e=0,i=r.length;i>e;e++)n=r[e],o.push(b.li(function(){return b.a({href:n.url},n.title)}));return o})}),e.exports={workflow_dropdown:w,editor_bar_pt:h}},function(e,t,n){var i,r,o,s,a,l,c,u,h;i=n(4),o=n(3),r=n(2),h=n(9),u=h.component(function(e,t,n){return h.span(e+".btn.btn-default.btn-xs",n)}),s=h.component(function(e,t,n){return h.div(e+".btn.btn-default.btn-xs",n)}),l=h.renderable(function(e,t){return null==e&&(e="Close"),null==t&&(t="close"),h.div(".btn.btn-default.btn-xs",{"data-dismiss":"modal"},function(){return h.h4(".modal-title",function(){return h.i(".fa.fa-"+t),h.text(e)})})}),c=h.renderable(function(e){return h.button(".navbar-toggle",{type:"button","data-toggle":"collapse","data-target":"#"+e},function(){return h.span(".sr-only","Toggle Navigation"),h.span(".icon-bar"),h.span(".icon-bar"),h.span(".icon-bar")})}),a=h.component(function(e,t,n){return h.a(e+".dropdown-toggle",{href:t.href,"data-toggle":"dropdown"},n)}),e.exports={spanbutton:u,divbutton:s,modal_close_button:l,navbar_collapse_button:c,dropdown_toggle:a}},function(e,t,n){var i,r,o,s,a=function(e,t){function n(){this.constructor=e}for(var i in t)l.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},l={}.hasOwnProperty;i=n(2),o=n(5),s=n(8),r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.onRoute=function(e,t,n){return s.navbar_set_active(t)},t}(i.Marionette.AppRouter),e.exports=r},function(e,t,n){var i,r,o,s,a,l,c,u,h,d,p,f=function(e,t){function n(){this.constructor=e}for(var i in t)m.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},m={}.hasOwnProperty;i=n(4),r=n(2),c=n(5),p=n(18),l=n(31),d=n(8),s=r.Radio.channel("global"),u=r.Radio.channel("messages"),h=r.Radio.channel("resources"),o=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return f(t,e),t.prototype.init_page=function(){},t.prototype.scroll_top=d.scroll_top_fast,t.prototype.navigate_to_url=d.navigate_to_url,t.prototype.navbar_set_active=d.navbar_set_active,t}(r.Marionette.Object),a=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return f(t,e),t.prototype.mainbus=s,t.prototype._get_region=function(e){return s.request("main:app:get-region",e)},t.prototype._show_content=function(e){var t;return t=this._get_region("content"),t.show(e)},t.prototype._set_resource=function(e){var t;return t=null===e?"":"/"===e[0]?e:"/"+e,this.resource_id=t,console.log("Resource_Id is ",this.resource_id),this.root_doc=h.request("get-document",this.resource_id)},t.prototype._make_editbar=function(){var e,t,n,i;return e=this.root_doc.get("data"),n=e.relationships.meta.current_user,t=this._get_region("editbar"),n&&"title"in n?(i=new l.EditBarView({model:this.root_doc}),t.show(i)):t.empty()},t.prototype._make_breadcrumbs=function(){var e,t,n,i;return n=this.root_doc.get("data"),t=n.relationships.meta.breadcrumbs,e=this._get_region("breadcrumbs"),t.length>1?(i=new l.BreadCrumbView({model:this.root_doc}),e.show(i)):e.empty()},t}(o),e.exports={BaseController:o,MainController:a}},function(e,t,n){var i,r,o,s,a,l,c,u,h,d,p,f,m,g,v,b,y=function(e,t){function n(){this.constructor=e}for(var i in t)w.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},w={}.hasOwnProperty;i=n(2),d=n(5),v=n(100),a=n(27),l=n(98),g=n(99),c=i.Radio.channel("global"),p=i.Radio.channel("messages"),u=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return y(t,e),t.prototype.template=l.MainLayoutTemplate,t}(i.Marionette.LayoutView),r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return y(t,e),t.prototype.template=v.nav_pt,window.NavTemplates=v,t.prototype.regions={usermenu:"#user-menu",mainmenu:"#main-menu"},t}(i.Marionette.LayoutView),h=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return y(t,e),t.prototype.template=v.nav_pt_search,t}(i.Marionette.ItemView),s=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return y(t,e),t.prototype.template=a.editor_bar_pt,t}(i.Marionette.LayoutView),o=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return y(t,e),t.prototype.template=g.breadcrumbs,t}(i.Marionette.ItemView),b=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return y(t,e),t.prototype.template=g.user_menu,t}(i.Marionette.ItemView),f=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return y(t,e),t.prototype.template=g.message_box,t.prototype.ui={close_button:"button.close"},t.prototype.events={"click @ui.close_button":"destroy_message"},t.prototype.destroy_message=function(){return p.request("delete-message",this.model)},t}(i.Marionette.ItemView),m=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return y(t,e),t.prototype.childView=f,t}(i.Marionette.CollectionView),e.exports={MainPageLayout:u,MainSearchFormView:h,EditBarView:s,BootstrapNavBarView:r,BreadCrumbView:o,UserMenuView:b,MessagesView:m}},,,,,,,,,,,function(e,t){!function(e,t,n,i){var r="ontouchstart"in n.documentElement,o="touchstart mousedown",s="touchmove mousemove",a="touchend mouseup";r&&e.each("touchstart touchmove touchend".split(" "),function(t,n){
e.event.fixHooks[n]=e.event.mouseHooks}),e(n).ready(function(){function t(e){for(var t={},n=e.match(/([^;:]+)/g)||[];n.length;)t[n.shift()]=n.shift().trim();return t}e("table").each(function(){"dnd"==e(this).data("table")&&e(this).tableDnD({onDragStyle:e(this).data("ondragstyle")&&t(e(this).data("ondragstyle"))||null,onDropStyle:e(this).data("ondropstyle")&&t(e(this).data("ondropstyle"))||null,onDragClass:e(this).data("ondragclass")==i&&"tDnD_whileDrag"||e(this).data("ondragclass"),onDrop:e(this).data("ondrop")&&new Function("table","row",e(this).data("ondrop")),onDragStart:e(this).data("ondragstart")&&new Function("table","row",e(this).data("ondragstart")),scrollAmount:e(this).data("scrollamount")||5,sensitivity:e(this).data("sensitivity")||10,hierarchyLevel:e(this).data("hierarchylevel")||0,indentArtifact:e(this).data("indentartifact")||'<div class="indent">&nbsp;</div>',autoWidthAdjust:e(this).data("autowidthadjust")||!0,autoCleanRelations:e(this).data("autocleanrelations")||!0,jsonPretifySeparator:e(this).data("jsonpretifyseparator")||"	",serializeRegexp:e(this).data("serializeregexp")&&new RegExp(e(this).data("serializeregexp"))||/[^\-]*$/,serializeParamName:e(this).data("serializeparamname")||!1,dragHandle:e(this).data("draghandle")||null})})}),jQuery.tableDnD={currentTable:null,dragObject:null,mouseOffset:null,oldX:0,oldY:0,build:function(t){return this.each(function(){this.tableDnDConfig=e.extend({onDragStyle:null,onDropStyle:null,onDragClass:"tDnD_whileDrag",onDrop:null,onDragStart:null,scrollAmount:5,sensitivity:10,hierarchyLevel:0,indentArtifact:'<div class="indent">&nbsp;</div>',autoWidthAdjust:!0,autoCleanRelations:!0,jsonPretifySeparator:"	",serializeRegexp:/[^\-]*$/,serializeParamName:!1,dragHandle:null},t||{}),e.tableDnD.makeDraggable(this),this.tableDnDConfig.hierarchyLevel&&e.tableDnD.makeIndented(this)}),this},makeIndented:function(t){var n,i,r=t.tableDnDConfig,o=t.rows,s=e(o).first().find("td:first")[0],a=0,l=0;if(e(t).hasClass("indtd"))return null;i=e(t).addClass("indtd").attr("style"),e(t).css({whiteSpace:"nowrap"});for(var c=0;c<o.length;c++)l<e(o[c]).find("td:first").text().length&&(l=e(o[c]).find("td:first").text().length,n=c);for(e(s).css({width:"auto"}),c=0;c<r.hierarchyLevel;c++)e(o[n]).find("td:first").prepend(r.indentArtifact);for(s&&e(s).css({width:s.offsetWidth}),i&&e(t).css(i),c=0;c<r.hierarchyLevel;c++)e(o[n]).find("td:first").children(":first").remove();return r.hierarchyLevel&&e(o).each(function(){a=e(this).data("level")||0,a<=r.hierarchyLevel&&e(this).data("level",a)||e(this).data("level",0);for(var t=0;t<e(this).data("level");t++)e(this).find("td:first").prepend(r.indentArtifact)}),this},makeDraggable:function(t){var n=t.tableDnDConfig;n.dragHandle&&e(n.dragHandle,t).each(function(){e(this).bind(o,function(i){return e.tableDnD.initialiseDrag(e(this).parents("tr")[0],t,this,i,n),!1})})||e(t.rows).each(function(){e(this).hasClass("nodrag")?e(this).css("cursor",""):e(this).bind(o,function(i){return"TD"==i.target.tagName?(e.tableDnD.initialiseDrag(this,t,this,i,n),!1):void 0}).css("cursor","move")})},currentOrder:function(){var t=this.currentTable.rows;return e.map(t,function(t){return(e(t).data("level")+t.id).replace(/\s/g,"")}).join("")},initialiseDrag:function(t,i,r,o,l){this.dragObject=t,this.currentTable=i,this.mouseOffset=this.getMouseOffset(r,o),this.originalOrder=this.currentOrder(),e(n).bind(s,this.mousemove).bind(a,this.mouseup),l.onDragStart&&l.onDragStart(i,r)},updateTables:function(){this.each(function(){this.tableDnDConfig&&e.tableDnD.makeDraggable(this)})},mouseCoords:function(e){return e.originalEvent.changedTouches?{x:e.originalEvent.changedTouches[0].clientX,y:e.originalEvent.changedTouches[0].clientY}:e.pageX||e.pageY?{x:e.pageX,y:e.pageY}:{x:e.clientX+n.body.scrollLeft-n.body.clientLeft,y:e.clientY+n.body.scrollTop-n.body.clientTop}},getMouseOffset:function(e,n){var i,r;return n=n||t.event,r=this.getPosition(e),i=this.mouseCoords(n),{x:i.x-r.x,y:i.y-r.y}},getPosition:function(e){var t=0,n=0;for(0==e.offsetHeight&&(e=e.firstChild);e.offsetParent;)t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return t+=e.offsetLeft,n+=e.offsetTop,{x:t,y:n}},autoScroll:function(e){var i=this.currentTable.tableDnDConfig,r=t.pageYOffset,o=t.innerHeight?t.innerHeight:n.documentElement.clientHeight?n.documentElement.clientHeight:n.body.clientHeight;n.all&&("undefined"!=typeof n.compatMode&&"BackCompat"!=n.compatMode?r=n.documentElement.scrollTop:"undefined"!=typeof n.body&&(r=n.body.scrollTop)),e.y-r<i.scrollAmount&&t.scrollBy(0,-i.scrollAmount)||o-(e.y-r)<i.scrollAmount&&t.scrollBy(0,i.scrollAmount)},moveVerticle:function(e,t){0!=e.vertical&&t&&this.dragObject!=t&&this.dragObject.parentNode==t.parentNode&&(0>e.vertical&&this.dragObject.parentNode.insertBefore(this.dragObject,t.nextSibling)||0<e.vertical&&this.dragObject.parentNode.insertBefore(this.dragObject,t))},moveHorizontal:function(t,n){var i,r=this.currentTable.tableDnDConfig;return r.hierarchyLevel&&0!=t.horizontal&&n&&this.dragObject==n?(i=e(n).data("level"),0<t.horizontal&&i>0&&e(n).find("td:first").children(":first").remove()&&e(n).data("level",--i),void(0>t.horizontal&&i<r.hierarchyLevel&&e(n).prev().data("level")>=i&&e(n).children(":first").prepend(r.indentArtifact)&&e(n).data("level",++i))):null},mousemove:function(t){var n,i,r,o,s,a=e(e.tableDnD.dragObject),l=e.tableDnD.currentTable.tableDnDConfig;return t&&t.preventDefault(),e.tableDnD.dragObject?("touchmove"==t.type&&event.preventDefault(),l.onDragClass&&a.addClass(l.onDragClass)||a.css(l.onDragStyle),i=e.tableDnD.mouseCoords(t),o=i.x-e.tableDnD.mouseOffset.x,s=i.y-e.tableDnD.mouseOffset.y,e.tableDnD.autoScroll(i),n=e.tableDnD.findDropTargetRow(a,s),r=e.tableDnD.findDragDirection(o,s),e.tableDnD.moveVerticle(r,n),e.tableDnD.moveHorizontal(r,n),!1):!1},findDragDirection:function(e,t){var n=this.currentTable.tableDnDConfig.sensitivity,i=this.oldX,r=this.oldY,o=i-n,s=i+n,a=r-n,l=r+n,c={horizontal:e>=o&&s>=e?0:e>i?-1:1,vertical:t>=a&&l>=t?0:t>r?-1:1};return 0!=c.horizontal&&(this.oldX=e),0!=c.vertical&&(this.oldY=t),c},findDropTargetRow:function(t,n){for(var i=0,r=this.currentTable.rows,o=this.currentTable.tableDnDConfig,s=0,a=null,l=0;l<r.length;l++)if(a=r[l],s=this.getPosition(a).y,i=parseInt(a.offsetHeight)/2,0==a.offsetHeight&&(s=this.getPosition(a.firstChild).y,i=parseInt(a.firstChild.offsetHeight)/2),n>s-i&&s+i>n)return t.is(a)||o.onAllowDrop&&!o.onAllowDrop(t,a)||e(a).hasClass("nodrop")?null:a;return null},processMouseup:function(){if(!this.currentTable||!this.dragObject)return null;var t=this.currentTable.tableDnDConfig,i=this.dragObject,r=0,o=0;e(n).unbind(s,this.mousemove).unbind(a,this.mouseup),t.hierarchyLevel&&t.autoCleanRelations&&e(this.currentTable.rows).first().find("td:first").children().each(function(){o=e(this).parents("tr:first").data("level"),o&&e(this).parents("tr:first").data("level",--o)&&e(this).remove()})&&t.hierarchyLevel>1&&e(this.currentTable.rows).each(function(){if(o=e(this).data("level"),o>1)for(r=e(this).prev().data("level");o>r+1;)e(this).find("td:first").children(":first").remove(),e(this).data("level",--o)}),t.onDragClass&&e(i).removeClass(t.onDragClass)||e(i).css(t.onDropStyle),this.dragObject=null,t.onDrop&&this.originalOrder!=this.currentOrder()&&e(i).hide().fadeIn("fast")&&t.onDrop(this.currentTable,i),this.currentTable=null},mouseup:function(t){return t&&t.preventDefault(),e.tableDnD.processMouseup(),!1},jsonize:function(e){var t=this.currentTable;return e?JSON.stringify(this.tableData(t),null,t.tableDnDConfig.jsonPretifySeparator):JSON.stringify(this.tableData(t))},serialize:function(){return e.param(this.tableData(this.currentTable))},serializeTable:function(e){for(var t="",n=e.tableDnDConfig.serializeParamName||e.id,i=e.rows,r=0;r<i.length;r++){t.length>0&&(t+="&");var o=i[r].id;o&&e.tableDnDConfig&&e.tableDnDConfig.serializeRegexp&&(o=o.match(e.tableDnDConfig.serializeRegexp)[0],t+=n+"[]="+o)}return t},serializeTables:function(){var t=[];return e("table").each(function(){this.id&&t.push(e.param(this.tableData(this)))}),t.join("&")},tableData:function(t){var n,i,r,o,s=t.tableDnDConfig,a=[],l=0,c=0,u=null,h={};if(t||(t=this.currentTable),!(t&&t.id&&t.rows&&t.rows.length))return{error:{code:500,message:"Not a valid table, no serializable unique id provided."}};o=s.autoCleanRelations&&t.rows||e.makeArray(t.rows),i=s.serializeParamName||t.id,r=i,n=function(e){return e&&s&&s.serializeRegexp?e.match(s.serializeRegexp)[0]:e},h[r]=[],!s.autoCleanRelations&&e(o[0]).data("level")&&o.unshift({id:"undefined"});for(var d=0;d<o.length;d++)if(s.hierarchyLevel){if(c=e(o[d]).data("level")||0,0==c)r=i,a=[];else if(c>l)a.push([r,l]),r=n(o[d-1].id);else if(l>c)for(var p=0;p<a.length;p++)a[p][1]==c&&(r=a[p][0]),a[p][1]>=l&&(a[p][1]=0);l=c,e.isArray(h[r])||(h[r]=[]),u=n(o[d].id),u&&h[r].push(u)}else u=n(o[d].id),u&&h[r].push(u);return h}},jQuery.fn.extend({tableDnD:e.tableDnD.build,tableDnDUpdate:e.tableDnD.updateTables,tableDnDSerialize:e.proxy(e.tableDnD.serialize,e.tableDnD),tableDnDSerializeAll:e.tableDnD.serializeTables,tableDnDData:e.proxy(e.tableDnD.tableData,e.tableDnD)})}(jQuery,window,window.document)},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var i,r,o=function(e,t){return function(){return e.apply(t,arguments)}},s=function(e,t){function n(){this.constructor=e}for(var i in t)a.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},a={}.hasOwnProperty;r=n(101),i=function(e){function t(){return this.invalid=o(this.invalid,this),this.valid=o(this.valid,this),t.__super__.constructor.apply(this,arguments)}return s(t,e),t.prototype.valid=function(e,t,n){return this.$("[data-validation="+t+"]").parent().removeClass("has-error").addClass("has-success")},t.prototype.invalid=function(e,t,n,i){return this.failure(this.model),this.$("[data-validation="+t+"]").parent().removeClass("has-success").addClass("has-error")},t}(r),e.exports=i},function(e,t,n){var i,r,o,s,a,l;i=n(4),r=n(3),l=n(9),o=l.renderable(function(e){return l.div(".form-group",function(){var t;return l.label(".control-label",{"for":e.input_id},e.label),(t=(null!=e?e.input_type:void 0)?e.input_type:l.input)("#"+e.input_id+".form-control",e.input_attributes)})}),s=l.renderable(function(e){return l.form({role:"form",method:"POST",action:"/login"},function(){return o({input_id:"input_username",label:"User Name",input_attributes:{name:"username",placeholder:"User Name"}}),o({input_id:"input_password",label:"Password",input_attributes:{name:"password",type:"password",placeholder:"Type your password here...."}}),l.button(".btn.btn-default",{type:"submit"},"login")})}),a=l.renderable(function(e){return o({input_id:"input_name",label:"Name",input_attributes:{name:"name",placeholder:"Name"}}),o({input_id:"input_content",input_type:l.textarea,label:"Content",input_attributes:{name:"content",placeholder:"..."}}),l.input(".btn.btn-default.btn-xs",{type:"submit",value:"Add"})}),e.exports={form_group_input_div:o,login_form:s,name_content_form:a}},function(e,t,n){var i,r,o,s,a;i=n(4),o=n(3),r=n(2),a=n(9),s=a.renderable(function(){return a.div("#ace-editor",{style:"position:relative;width:100%;height:40em;"})}),e.exports={ace_editor_div:s}},,,function(e,t,n){!function(t){e.exports=t(n(2),n(3))}(function(e,t){return e.Validation=function(e){"use strict";var t={forceUpdate:!1,selector:"name",labelFormatter:"sentenceCase",valid:Function.prototype,invalid:Function.prototype},n={formatLabel:function(e,n){return l[t.labelFormatter](e,n)},format:function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return t.replace(/\{(\d+)\}/g,function(t,n){return"undefined"!=typeof e[n]?e[n]:t})}},i=function(t,n,r){return n=n||{},r=r||"",e.each(t,function(e,o){t.hasOwnProperty(o)&&(e&&"object"==typeof e&&!(e instanceof Date||e instanceof RegExp)?i(e,n,r+o+"."):n[r+o]=e)}),n},r=function(){var r=function(t){return e.reduce(e.keys(t.validation||{}),function(e,t){return e[t]=void 0,e},{})},s=function(t,n){var i=t.validation?t.validation[n]||{}:{};return(e.isFunction(i)||e.isString(i))&&(i={fn:i}),e.isArray(i)||(i=[i]),e.reduce(i,function(t,n){return e.each(e.without(e.keys(n),"msg"),function(e){t.push({fn:c[e],val:n[e],msg:n.msg})}),t},[])},a=function(t,i,r,o){return e.reduce(s(t,i),function(s,a){var l=e.extend({},n,c),u=a.fn.call(l,r,i,a.val,t,o);return u===!1||s===!1?!1:u&&!s?a.msg||u:s},"")},l=function(t,n){var r,o={},s=!0,l=e.clone(n),c=i(n);return e.each(c,function(e,n){r=a(t,n,e,l),r&&(o[n]=r,s=!1)}),{invalidAttrs:o,isValid:s}},u=function(t,n){return{preValidate:function(t,n){return a(this,t,n,e.extend({},this.attributes))},isValid:function(t){var n=i(this.attributes);return e.isString(t)?!a(this,t,n[t],e.extend({},this.attributes)):e.isArray(t)?e.reduce(t,function(t,i){return t&&!a(this,i,n[i],e.extend({},this.attributes))},!0,this):(t===!0&&this.validate(),this.validation?this._isValid:!0)},validate:function(o,s){var a=this,c=!o,u=e.extend({},n,s),h=r(a),d=e.extend({},h,a.attributes,o),p=i(o||d),f=l(a,d);return a._isValid=f.isValid,e.each(h,function(e,n){var i=f.invalidAttrs.hasOwnProperty(n);i||u.valid(t,n,u.selector)}),e.each(h,function(e,n){var i=f.invalidAttrs.hasOwnProperty(n),r=p.hasOwnProperty(n);i&&(r||c)&&u.invalid(t,n,f.invalidAttrs[n],u.selector)}),e.defer(function(){a.trigger("validated",a._isValid,a,f.invalidAttrs),a.trigger("validated:"+(a._isValid?"valid":"invalid"),a,f.invalidAttrs)}),!u.forceUpdate&&e.intersection(e.keys(f.invalidAttrs),e.keys(p)).length>0?f.invalidAttrs:void 0}}},h=function(t,n,i){e.extend(n,u(t,i))},d=function(e){delete e.validate,delete e.preValidate,delete e.isValid},p=function(e){h(this.view,e,this.options)},f=function(e){d(e)};return{version:"0.7.1",configure:function(n){e.extend(t,n)},bind:function(n,i){var r=n.model,s=n.collection;if(i=e.extend({},t,o,i),"undefined"==typeof r&&"undefined"==typeof s)throw"Before you execute the binding your view must have a model or a collection.\nSee http://thedersen.com/projects/backbone-validation/#using-form-model-validation for more information.";r?h(n,r,i):s&&(s.each(function(e){h(n,e,i)}),s.bind("add",p,{view:n,options:i}),s.bind("remove",f))},unbind:function(e){var t=e.model,n=e.collection;t&&d(e.model),n&&(n.each(function(e){d(e)}),n.unbind("add",p),n.unbind("remove",f))},mixin:u(null,t)}}(),o=r.callbacks={valid:function(e,t,n){e.$("["+n+'~="'+t+'"]').removeClass("invalid").removeAttr("data-error")},invalid:function(e,t,n,i){e.$("["+i+'~="'+t+'"]').addClass("invalid").attr("data-error",n)}},s=r.patterns={digits:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},a=r.messages={required:"{0} is required",acceptance:"{0} must be accepted",min:"{0} must be greater than or equal to {1}",max:"{0} must be less than or equal to {1}",range:"{0} must be between {1} and {2}",length:"{0} must be {1} characters",minLength:"{0} must be at least {1} characters",maxLength:"{0} must be at most {1} characters",rangeLength:"{0} must be between {1} and {2} characters",oneOf:"{0} must be one of: {1}",equalTo:"{0} must be the same as {1}",pattern:"{0} must be a valid {1}"},l=r.labelFormatters={none:function(e){return e},sentenceCase:function(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,t){return 0===t?e.toUpperCase():" "+e.toLowerCase()}).replace("_"," ")},label:function(e,t){return t.labels&&t.labels[e]||l.sentenceCase(e,t)}},c=r.validators=function(){var t=String.prototype.trim?function(e){return null===e?"":String.prototype.trim.call(e)}:function(e){var t=/^\s+/,n=/\s+$/;return null===e?"":e.toString().replace(t,"").replace(n,"")},n=function(t){return e.isNumber(t)||e.isString(t)&&t.match(s.number)},i=function(n){return!(e.isNull(n)||e.isUndefined(n)||e.isString(n)&&""===t(n))};return{fn:function(t,n,i,r,o){return e.isString(i)&&(i=r[i]),i.call(r,t,n,o)},required:function(t,n,r,o,s){var l=e.isFunction(r)?r.call(o,t,n,s):r;return l||i(t)?l&&!i(t)?this.format(a.required,this.formatLabel(n,o)):void 0:!1},acceptance:function(t,n,i,r){return"true"===t||e.isBoolean(t)&&t!==!1?void 0:this.format(a.acceptance,this.formatLabel(n,r))},min:function(e,t,i,r){return!n(e)||i>e?this.format(a.min,this.formatLabel(t,r),i):void 0},max:function(e,t,i,r){return!n(e)||e>i?this.format(a.max,this.formatLabel(t,r),i):void 0},range:function(e,t,i,r){return!n(e)||e<i[0]||e>i[1]?this.format(a.range,this.formatLabel(t,r),i[0],i[1]):void 0},length:function(e,n,r,o){return i(e)&&t(e).length===r?void 0:this.format(a.length,this.formatLabel(n,o),r)},minLength:function(e,n,r,o){return!i(e)||t(e).length<r?this.format(a.minLength,this.formatLabel(n,o),r):void 0},maxLength:function(e,n,r,o){return!i(e)||t(e).length>r?this.format(a.maxLength,this.formatLabel(n,o),r):void 0},rangeLength:function(e,n,r,o){return!i(e)||t(e).length<r[0]||t(e).length>r[1]?this.format(a.rangeLength,this.formatLabel(n,o),r[0],r[1]):void 0},oneOf:function(t,n,i,r){return e.include(i,t)?void 0:this.format(a.oneOf,this.formatLabel(n,r),i.join(", "))},equalTo:function(e,t,n,i,r){return e!==r[n]?this.format(a.equalTo,this.formatLabel(t,i),this.formatLabel(n,i)):void 0},pattern:function(e,t,n,r){return i(e)&&e.toString().match(s[n]||n)?void 0:this.format(a.pattern,this.formatLabel(t,r),n)}}}();return r}(t),e.Validation})},,,,,,,,,,,,,,function(e,t,n){var i,r,o,s,a,l,c,u=function(e,t){function n(){this.constructor=e}for(var i in t)h.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},h={}.hasOwnProperty;i=n(4),c=n(4),s=n(3),r=n(2),o=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return u(t,e),t.prototype.defaults={brand:{name:"Brand",url:"/"},frontdoor_app:"frontdoor",hasUser:!1,frontdoor_sidebar:[{name:"Home",url:"/"}],applets:[],regions:{},routes:[]},t}(r.Model),l={mainview:"body",navbar:"#navbar-view-container",editbar:"#editor-bar-container",sidebar:"#sidebar",breadcrumbs:"#breadcrumbs",content:"#main-content",messages:"#messages",footer:"#footer",modal:"#modal",usermenu:"#user-menu",search:"#form-search-container"},a=new o({hasUser:!0,brand:{name:"Kotti",url:"/"},applets:[{appname:"editcontents",name:"Edit Contents",url:"#editor"},{appname:"setupusers",name:"Setup Users",url:"#setupusers"}],regions:l}),e.exports=a},function(e,t,n){var i,r,o,s,a,l,c,u,h,d,p,f,m,g=function(e,t){function n(){this.constructor=e}for(var i in t)v.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},v={}.hasOwnProperty;i=n(4),f=n(3),r=n(2),u=n(5),d=n(16),c=r.Radio.channel("global"),h=r.Radio.channel("messages"),p=r.Radio.channel("resources"),a=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return g(t,e),t.prototype.copy_status="copy",t.prototype._add_models=function(e,t){return this.reset(),this.add(e),this.copy_status=t},t.prototype.copy=function(e){return this._add_models(e,"copy")},t.prototype.cut=function(e){return this._add_models(e,"cut")},t.prototype.paste=function(){var e;return e=this.models.slice(),this.reset(),e},t}(r.Collection),m=new a,c.reply("main:app:kotti-clipboard",function(){return m}),o=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return g(t,e),t.prototype.parse=function(e){return e.data},t}(r.Collection),s=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return g(t,e),t.prototype.idAttribute="oid",t}(d.BaseKottiResource),l=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return g(t,e),t.prototype.model=s,t.prototype.url=function(){return this.resource_id+"/@@contents-json"},t}(o),p.reply("get-document-contents",function(e){var t;return null==e&&(e=""),t=new l,t.resource_id=e,t}),e.exports=a},function(e,t,n){var i,r,o,s,a,l,c,u,h,d,p,f=function(e,t){function n(){this.constructor=e}for(var i in t)m.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},m={}.hasOwnProperty;i=n(4),r=n(2),c=n(5),p=n(18),d=n(8),l=n(31),a=n(30).MainController,s=r.Radio.channel("global"),h=r.Radio.channel("resources"),u=r.Radio.channel("messages"),o=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return f(t,e),t.prototype._get_doc_and_render_view=function(e){var t;return t=this.root_doc.fetch(),t.done(function(t){return function(){var n;return t._make_editbar(),t._make_breadcrumbs(),n=new e({model:t.root_doc}),t._show_content(n)}}(this))},t.prototype._get_contents_and_render_view=function(e){return n.e(0,function(t){return function(){var i,r;return i=n(26),t._set_resource(e),r=t.root_doc.fetch(),r.done(function(){var n,r;return n=h.request("get-document-contents",e),r=n.fetch(),r.done(function(){var e;return t._make_editbar(),t._make_breadcrumbs(),e=new i.ContentsView({model:t.root_doc,collection:n}),t._show_content(e)})})}}(this))},t.prototype.manage_contents=function(e){return this._get_contents_and_render_view(e)},t.prototype._add_document=function(){return n.e(0,function(e){return function(){var t,i,r,o;return t=n(16),i=n(26),r=new t.BaseKottiModel,o=new i.NewDocumentView({model:r}),window.newdocview=o,e._show_content(o)}}(this))},t.prototype.add_node=function(e,t){var n;return console.log("Add "+e+" node to this resource "+t),this._set_resource(t),"document"===e?this._add_document():(n="Unable to add type "+e,u.request("display-message",n,"error"))},t.prototype.edit_node=function(e){return n.e(0,function(t){return function(){var i;return i=n(26),t._set_resource(e),t._get_doc_and_render_view(i.EditorView)}}(this))},t.prototype.ace_edit_node=function(e){return n.e(0,function(t){return function(){var i;return i=n(26),t._set_resource(e),t._get_doc_and_render_view(i.AceEditorView)}}(this))},t}(a),e.exports=o},function(e,t,n){var i,r,o,s,a,l,c,u,h,d,p=function(e,t){function n(){this.constructor=e}for(var i in t)f.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},f={}.hasOwnProperty;r=n(2),l=n(5),d=n(8),o=n(29),s=n(88),a=r.Radio.channel("global"),c=r.Radio.channel("messages"),u=r.Radio.channel("resources"),i=r.Radio.channel("editcontents"),h=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return p(t,e),t.prototype.appRoutes={"editor/contents":"manage_contents","editor/contents/*resource":"manage_contents","editor/edit":"edit_node","editor/edit/*resource":"edit_node","editor/aceedit":"ace_edit_node","editor/aceedit/*resource":"ace_edit_node","editor/addnode":"add_node","editor/addnode/*resource":"add_node","editor/add_:content_type":"add_node","editor/add_:content_type/*resource":"add_node"},t}(o),a.reply("applet:editcontents:route",function(){var e,t;return console.log("editcontents:route being handled"),e=new s(a),e.root_doc=u.request("current-document"),t=new h({controller:e}),i.reply("contents-changed",function(t){return function(){return e.manage_contents(e.resource_id)}}(this))})},function(e,t,n){var i,r,o,s,a,l,c,u,h,d,p=function(e,t){function n(){this.constructor=e}for(var i in t)f.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},f={}.hasOwnProperty;i=n(4),r=n(2),l=n(5),d=n(18),a=n(30).MainController,s=r.Radio.channel("global"),c=r.Radio.channel("messages"),u=r.Radio.channel("resources"),h=n(93),o=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return p(t,e),t.prototype.make_main_content=function(){var e;return this._make_editbar(),this._make_breadcrumbs(),e=new h.FrontDoorMainView({model:this.root_doc}),this._show_content(e)},t.prototype._view_resource=function(){var e;return e=this.root_doc.fetch(),e.done(function(e){return function(){var t,n;return e._make_editbar(),e._make_breadcrumbs(),n=new h.FrontDoorMainView({model:e.root_doc}),e._show_content(n),t=e.root_doc.get("data"),i("title").text(t.attributes.title)}}(this))},t.prototype.view_resource=function(e){return this._set_resource(e),this._view_resource()},t.prototype.frontdoor=function(){return this._view_resource()},t.prototype.start=function(){return this.make_main_content()},t}(a),e.exports=o},function(e,t,n){var i,r,o,s,a,l,c,u,h,d=function(e,t){function n(){this.constructor=e}for(var i in t)p.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},p={}.hasOwnProperty;i=n(2),a=n(5),h=n(8),r=n(29),o=n(90),s=i.Radio.channel("global"),l=i.Radio.channel("messages"),c=i.Radio.channel("resources"),u=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return d(t,e),t.prototype.appRoutes={"":"view_resource",frontdoor:"view_resource","frontdoor/view":"view_resource","frontdoor/view/*resource":"view_resource"},t}(r),s.reply("applet:frontdoor:route",function(){var e,t;return e=new o(s),e.root_doc=c.request("current-document"),t=new u({controller:e})})},function(e,t,n){var i,r,o,s,a,l,c,u,h,d,p;d=n(9),c=n(18),h=n(17),u=h.navbar_collapse_button,o=h.dropdown_toggle,l=h.frontdoor_url,s=h.editor_url,p=n(27).workflow_dropdown,a=d.renderable(function(e){return d.raw(e.data.attributes.body)}),i=d.renderable(function(e){var t;return t=e.data.attributes,d.article(".document-view.content",function(){return d.h1(t.title),d.p(".lead",t.description),d.div(".body",function(){return d.raw(t.body)})})}),r=d.renderable(function(e){var t,n;return t=e.data.attributes,n=e.data.relationships.meta,d.article(".document-view.content",function(){return d.h1(t.title),d.p(".lead",t.description),d.h2("Contents"),d.div(".body",function(){return d.table(".table.table-condensed",function(){return d.thead(function(){return d.tr(function(){return d.th("Title"),d.th("Type"),d.th("Creation Date"),d.th("Modification Date")})}),d.tbody(function(){var e,t,i,r,o,s,a;for(o=n.children,s=[],i=0,r=o.length;r>i;i++)e=o[i],a=e.data.relationships.meta.type_info,t=l(e.path),s.push(d.tr(function(){return d.td(function(){return d.a({href:t},e.data.attributes.title)}),d.td(function(){return d.a({href:t},a.title)}),d.td(function(){return d.a({href:t},e.meta.creation_date)}),d.td(function(){return d.a({href:t},e.meta.modification_date)})}));return s})})})})}),e.exports={frontdoor_main:a,DefaultViewTemplate:i,FolderViewTemplate:r}},function(e,t,n){var i,r,o,s,a,l,c,u,h,d,p=function(e,t){function n(){this.constructor=e}for(var i in t)f.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},f={}.hasOwnProperty;i=n(2),l=n(5),r=n(92),d=n(42),u=n(8),h=u.remove_trailing_slashes,c=u.make_json_post,n(25),a=i.Radio.channel("global"),s=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return p(t,e),t.prototype.template=r.DefaultViewTemplate,t.prototype.onDomRefresh=function(){return $(".ui-draggable").draggable()},t}(i.Marionette.ItemView),o=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return p(t,e),t.prototype.template=r.FolderViewTemplate,t}(i.Marionette.ItemView),e.exports={FrontDoorMainView:s,FolderView:o}},function(e,t,n){var i,r,o,s,a,l,c,u,h,d,p,f,m=function(e,t){function n(){this.constructor=e}for(var i in t)g.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},g={}.hasOwnProperty;i=n(4),o=n(2),c=n(5),p=n(8),l=n(30).MainController,f=n(97),h=n(16),a=o.Radio.channel("global"),d=o.Radio.channel("resources"),u=o.Radio.channel("messages"),r=o.Radio.channel("setupusers"),s=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return m(t,e),t.prototype._update_views_common=function(){return this._make_editbar(),this._make_breadcrumbs(),this._setup_dashboard()},t.prototype._setup_dashboard=function(){var e,t;return e=this._get_region("content"),console.log("content.currentView",e.currentView),e.currentView instanceof f.DashboardView?void 0:(console.log("Create dashboard layout"),t=new f.DashboardView,this._show_content(t),this.layout=t)},t.prototype.setup_users=function(){var e,t;return console.log("Setup users"),this._update_views_common(),t=new f.SearchUsersView,e=this.layout.regionManager.get("searchform"),e.show(t)},t.prototype.display_search_results=function(e){var t,n,i;return this._update_views_common(),t=new o.Model(e),i=new f.SearchResultsView({model:t}),n=this.layout.regionManager.get("usercontent"),n.show(i)},t}(l),e.exports=s},function(e,t,n){var i,r,o,s,a,l,c,u,h,d,p=function(e,t){function n(){this.constructor=e}for(var i in t)f.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},f={}.hasOwnProperty;r=n(2),l=n(5),d=n(8),o=n(29),s=n(94),a=r.Radio.channel("global"),c=r.Radio.channel("messages"),u=r.Radio.channel("resources"),i=r.Radio.channel("setupusers"),h=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return p(t,e),t.prototype.appRoutes={setupusers:"setup_users","setupusers/":"setup_users"},t}(o),a.reply("applet:setupusers:route",function(){var e,t;return console.log("setupusers:route being handled"),e=new s(a),e.root_doc=u.request("current-document"),t=new h({controller:e}),i.reply("search-results-returned",function(t){return function(t){return e.display_search_results(t)}}(this))})},function(e,t,n){var i,r,o,s,a,l,c,u,h,d,p,f,m,g,v,b,y,w,_,k,x,E=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};_=n(9),u=n(18),p=n(28),h=p.navbar_collapse_button,s=p.dropdown_toggle,f=n(17),c=f.frontdoor_url,a=f.editor_url,x=n(27).workflow_dropdown,l=n(68).form_group_input_div,r=n(69).ace_editor_div,m=n(8),o=m.capitalize,w=m.str_startswith,i=Backbone.Radio.channel("global"),k=_.renderable(function(){return _.div(".row",function(){return _.div("#useradmin-sidebar.col-md-3.left-column.panel.panel-default",function(){return _.span(".label.label-primary","Search Users/Groups"),_.div("#useradmin-search-form"),_.div(".form-group",function(){return _.div(".label.label-primary","Add Users/Groups"),_.div("#adduser-btn.form-control.btn.btn-default",function(){
return _.text("Add User")}),_.div("#addgroup-btn..form-control.btn.btn-default",function(){return _.text("Add Group")})})}),_.div("#useradmin-content.col-md-9.right-column")})}),y=_.renderable(function(e){return _.ul(".nav.nav-tabs",function(){return _.li(".active",function(){return _.a({href:"#search-tab","data-toggle":"tab"},function(){return"Search users(s) / group(s)"})}),_.li(function(){return _.a({href:"#add-user-tab","data-toggle":"tab"},function(){return"Add user"})}),_.li(function(){return _.a({href:"#add-group-tab","data-toggle":"tab"},function(){return"Add group"})})})}),g=_.renderable(function(e){return _.div("#search-tab.tab-pane",function(){return _.div(".panel.panel-default",{style:"margin-top:2em;"},function(){return _.div(".panel-heading",function(){return _.h3(".panel-title","Find users or groups")}),_.div(".panel-body",function(){return _.form(".form",function(){return _.div(".control-group",function(){return _.label({"for":"search-query"},"User- / groupname"),_.input("#search-query.form-control",{type:"search",name:"query",placeholder:"Search users and groups"}),_.span(".help-block","blank search text finds all.")}),_.button(".btn.btn-primary",{type:"submit",name:"search"},function(){return _.i(".glyphicon.glyphicon-search"),_.span("Search")})})})})})}),b=_.renderable(function(e){return l({input_id:"input_query",label:"Name",input_attributes:{name:"query"}}),_.input(".btn.btn-primary",{type:"submit",value:"search"})}),d=_.renderable(function(e,t){var n,i,r;return r=e.principal,n=!r.name.indexOf("group:"),n=w(r.name,"group:"),i=!n,_.tr(function(){var i,o,s,a;for(_.td(function(){return _.span(function(){return n?"Group":"User"})}),_.td(function(){return _.img({src:r.avatar_url,alt:"Gravatar"}),_.a({href:"#setupusers/user/"+r.name},r.title),(null!=r?r.email:void 0)?_.div("<"+r.email+">"):void 0}),s=[],i=0,o=t.length;o>i;i++)a=t[i],console.log("ROLE",a),s.push(_.td(function(){var t,n,i,o;return t={type:"checkbox",title:"Assign role "+a.name},n=a.name,E.call(e.enabled,n)>=0&&(t.checked="checked"),i=a.name,E.call(e.disabled,i)>=0&&(t.disabled="disabled"),_.input(t),t={type:"hidden",name:"orig-role::"+r.name+"::"+a.name,value:(o=a.name,E.call(e.enabled,o)>=0?"1":"")},_.input(t)}));return s})}),v=_.renderable(function(e){return _.h2("Assign global roles"),_.table(".table.table-bordered.table-hover",function(){return _.thead(function(){return _.tr(function(){var t,n,i,r,o;for(_.th("Type"),_.th("Name"),i=e.available_roles,r=[],t=0,n=i.length;n>t;t++)o=i[t],r.push(_.th(o.title));return r})}),_.tbody(function(){var t,n,i,r,o;for(r=e.entries,o=[],n=0,i=r.length;i>n;n++)t=r[n],o.push(d(t,e.available_roles));return o})}),_.div(".btn.btn-primary",{type:"submit",value:"apply"},function(){return _.i(".glyphicon.glyphicon-save"),_.span("Apply changes")})}),e.exports={user_admin_dashboard:k,search_users_form:b,search_results_form:v}},function(e,t,n){var i,r,o,s,a,l,c,u,h,d,p,f,m,g,v=function(e,t){function n(){this.constructor=e}for(var i in t)b.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},b={}.hasOwnProperty;o=n(2),c=n(5),n(25),g=n(42),r=n(96),f=n(8),m=f.remove_trailing_slashes,p=f.make_json_post,u=n(16),l=o.Radio.channel("global"),i=o.Radio.channel("setupusers"),s=n(67),a=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return v(t,e),t.prototype.template=r.user_admin_dashboard,t.prototype.regions={searchform:"#useradmin-search-form",userbar:"#useradmin-sidebar",usercontent:"#useradmin-content"},t}(o.Marionette.LayoutView),d=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return v(t,e),t.prototype.template=r.search_users_form,t.prototype.ui={query:'input[name="query"]'},t.prototype.createModel=function(){var e;return new(e=l.request("base-kotti-model"))},t.prototype.updateModel=function(){return this.model.url="/@@setup-users-json",this.model.set("query",this.ui.query.val()),this.model.set("search","")},t.prototype.saveModel=function(){var e;return e={success:function(e){return function(t,n){return e.onSuccess(e.model,n)}}(this),error:function(e){return function(){return e.trigger("save:form:failure",e.model)}}(this)},this.model.save({},e)},t.prototype.onSuccess=function(e,t){return this.render(),console.log("model, response, options",e,t),i.request("search-results-returned",t.data)},t}(s),h=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return v(t,e),t.prototype.template=r.search_results_form,t.prototype._baseUI=function(){return{submit:'div[type="submit"]',activityIndicator:".spinner"}},t.prototype.createModel=function(){return this.model},t.prototype.updateModel=function(){return window.fview=this},t}(s),e.exports={DashboardView:a,SearchUsersView:d,SearchResultsView:h}},function(e,t,n){var i,r,o,s,a;i=n(4),s=n(3),a=n(9),o=a.renderable(function(){return a.div("#navbar-view-container"),a.div("#editor-bar-container"),a.div(".container",function(){return a.div("#breadcrumbs"),a.div(".row",function(){return a.div("col-md-12",function(){return a.div("#messages")}),a.div("#main-content.col-md-9"),a.div("#right-slot.col-md-3.right-column")})}),a.div("#footer"),a.div("#modal")}),r=a.renderable(function(e){var t;return t=e.data.attributes,a.article(".document-view.content",function(){return a.h1(t.title),a.p(".lead",t.description),a.div(".body",function(){return a.raw(t.body)})})}),e.exports={MainLayoutTemplate:o,MainContentTemplate:r}},function(e,t,n){var i,r,o,s,a,l,c,u,h,d;i=n(4),r=n(3),h=n(9),u=n(17),s=u.dropdown_toggle,a=u.frontdoor_url,d=h.renderable(function(e){var t;return t=e.data.relationships.meta.current_user,h.ul("#user-menu.ctx-menu.nav.navbar-nav",function(){return h.li(".dropdown",function(){return h.a(".dropdown-toggle",{"data-toggle":"dropdown"},function(){return t&&"title"in t?h.text(t.title):h.text("Guest")}),h.ul(".dropdown-menu",function(){return t?(h.li(function(){return h.a({href:"/"},"MainPage")}),h.li(function(){return h.a({href:"/logout"},"Logout")})):h.li(function(){return h.a({href:"/login"},"Login")})})})})}),o=h.renderable(function(e){return h.ol(".breadcrumb",function(){var t,n,i,r,o;for(h.small("You are here:  "),r=e.data.relationships.meta.breadcrumbs,o=[],t=0,i=r.length;i>t;t++)n=r[t],o.push(h.li(function(){return h.a({href:a(n.path)},n.title)}));return o})}),l=h.renderable(function(e){var t;return t=e.level,"error"===t&&(t="danger"),h.div(".alert.alert-"+t,function(){return h.button(".close",{type:"button","aria-hidden":!0},function(){return h.raw("&times;")}),h.text(e.content)})}),c=h.renderable(function(e){var t;return t=e.level,"error"===t&&(t="danger"),h.div(".alert-dismissable.alert.alert-"+t,function(){return h.button(".close",{type:"button","data-dismiss":"alert","aria-hidden":!0},function(){return h.raw("&times;")}),h.text(e.content)})}),e.exports={user_menu:d,breadcrumbs:o,message_box:l,message_box_dismissable:c}},function(e,t,n){var i,r,o,s,a,l,c,u,h,d;i=n(4),r=n(3),d=n(9),h=n(28),u=h.navbar_collapse_button,o=h.dropdown_toggle,s=n(17).frontdoor_url,c=d.renderable(function(e){var t;return t=e.data.relationships.meta,d.form("#form-search.navbar-form.navbar-right",{role:"search",method:"post",action:t.root_url+"@@search-results"},function(){return d.div(".form-group",function(){return d.input(".form-control",{name:"search-term",type:"search",placeholder:"Search..."})}),d.button(".btn.btn-default",{type:"submit",name:"search-submit",value:"search",style:"display: none;"},function(){return d.raw("&#8594")})})}),l=d.renderable(function(e){var t;return t=e.data.relationships.meta,d.div(".container-fluid",function(){return d.div(".navbar-header",function(){return u("navbar-view-collapse"),d.a(".navbar-brand",{href:"#frontdoor"},t.site_title)}),d.div("#navbar-view-collapse.collapse.navbar-collapse",function(){return d.ul(".nav.navbar-nav",function(){var e,n,i,r,o,a;for(o=t.navitems,a=[],e=0,r=o.length;r>e;e++)i=o[e],n="",i.inside&&(n=".active"),a.push(d.li(n,function(){return d.a({href:s(i.path),title:i.description},i.title)}));return a}),d.ul("#user-menu.nav.navbar-nav.navbar-right"),d.div("#form-search-container")})})}),a=d.renderable(function(e){return d.nav("#navbar-view.navbar.navbar-static-top.navbar-inverse",{xmlns:"http://www.w3.org/1999/xhtml","xml:lang":"en",role:"navigation"},function(){return l(e)})}),e.exports={nav_pt_search:c,nav_pt:a}},function(e,t,n){var i,r,o,s,a=function(e,t){return function(){return e.apply(t,arguments)}},l=function(e,t){function n(){this.constructor=e}for(var i in t)c.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},c={}.hasOwnProperty;s=n(3),r=n(5),o=n(72),i=function(e){function t(){this.invalid=a(this.invalid,this),this.valid=a(this.valid,this),t.__super__.constructor.apply(this,arguments),this.listenTo(this,"render",this.hideActivityIndicator),this.listenTo(this,"render",this.prepareModel),this.listenTo(this,"save:form:success",this.success),this.listenTo(this,"save:form:failure",this.failure)}return l(t,e),t.prototype.delegateEvents=function(e){return this.ui=s.extend(this._baseUI(),s.result(this,"ui")),this.events=s.extend(this._baseEvents(),s.result(this,"events")),t.__super__.delegateEvents.call(this,e)},t.prototype.tagName="form",t.prototype._baseUI=function(){return{submit:'input[type="submit"]',activityIndicator:".spinner"}},t.prototype._baseEvents=function(){var e;return e={"change [data-validation]":this.validateField,"blur [data-validation]":this.validateField,"keyup [data-validation]":this.validateField},e["click "+this.ui.submit]=this.processForm,e},t.prototype.createModel=function(){throw new Error("implement #createModel in your FormView subclass to return a Backbone model")},t.prototype.prepareModel=function(){return this.model=this.createModel(),this.setupValidation()},t.prototype.validateField=function(e){var t,n;return t=$(e.target).attr("data-validation"),n=$(e.target).val(),this.model.preValidate(t,n)?this.invalid(this,t):this.valid(this,t)},t.prototype.processForm=function(e){return e.preventDefault(),this.showActivityIndicator(),this.updateModel(),this.saveModel()},t.prototype.updateModel=function(){throw new Error("implement #updateModel in your FormView subclass to update the attributes of @model")},t.prototype.saveModel=function(){var e;return e={success:function(e){return function(){return e.trigger("save:form:success",e.model)}}(this),error:function(e){return function(){return e.trigger("save:form:failure",e.model)}}(this)},this.model.save({},e)},t.prototype.success=function(e){return this.render(),this.onSuccess(e)},t.prototype.onSuccess=function(e){return null},t.prototype.failure=function(e){return this.hideActivityIndicator(),this.onFailure(e)},t.prototype.onFailure=function(e){return null},t.prototype.showActivityIndicator=function(){return this.ui.activityIndicator.show(),this.ui.submit.hide()},t.prototype.hideActivityIndicator=function(){return this.ui.activityIndicator.hide(),this.ui.submit.show()},t.prototype.setupValidation=function(){return Backbone.Validation.unbind(this),Backbone.Validation.bind(this,{valid:this.valid,invalid:this.invalid})},t.prototype.valid=function(e,t,n){return this.$("[data-validation="+t+"]").removeClass("invalid").addClass("valid")},t.prototype.invalid=function(e,t,n,i){return this.failure(this.model),this.$("[data-validation="+t+"]").removeClass("valid").addClass("invalid")},t}(Backbone.Marionette.ItemView),e.exports=i}]);
//# sourceMappingURL=dashboard-a1c45d547f88bb85852a.js.map